<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:55:31 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>Config::DOMConfigurator</title>

</head>
<body>
<h1>Log::Log4perl::Config::DOMConfigurator</h1>



<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">Log::Log4perl::Config::DOMConfigurator
&minus; reads xml config files</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
<br>
&minus;&minus;using the log4j DTD&minus;&minus; <br>

&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
<br>
&lt;?xml version=&quot;1.0&quot;
encoding=&quot;UTF&minus;8&quot;?&gt; <br>
&lt;!DOCTYPE log4j:configuration SYSTEM
&quot;log4j.dtd&quot;&gt; <br>
&lt;log4j:configuration
xmlns:log4j=&quot;http://jakarta.apache.org/log4j/&quot;&gt;
<br>
&lt;appender name=&quot;FileAppndr1&quot;
class=&quot;org.apache.log4j.FileAppender&quot;&gt; <br>
&lt;layout
class=&quot;Log::Log4perl::Layout::PatternLayout&quot;&gt;
<br>
&lt;param name=&quot;ConversionPattern&quot; <br>
value=&quot;%d %4r [%t] %&minus;5p %c %t &minus;
%m%n&quot;/&gt; <br>
&lt;/layout&gt; <br>
&lt;param name=&quot;File&quot;
value=&quot;t/tmp/DOMtest&quot;/&gt; <br>
&lt;param name=&quot;Append&quot;
value=&quot;false&quot;/&gt; <br>
&lt;/appender&gt; <br>
&lt;category name=&quot;a.b.c.d&quot;
additivity=&quot;false&quot;&gt; <br>
&lt;level value=&quot;warn&quot;/&gt; &lt;!&minus;&minus;
note lowercase! &minus;&minus;&gt; <br>
&lt;appender&minus;ref ref=&quot;FileAppndr1&quot;/&gt; <br>
&lt;/category&gt; <br>
&lt;root&gt; <br>
&lt;priority value=&quot;warn&quot;/&gt; <br>
&lt;appender&minus;ref ref=&quot;FileAppndr1&quot;/&gt; <br>
&lt;/root&gt; <br>
&lt;/log4j:configuration&gt; <br>

&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
<br>
&minus;&minus;using the log4perl DTD&minus;&minus; <br>

&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
<br>
&lt;?xml version=&quot;1.0&quot;
encoding=&quot;UTF&minus;8&quot;?&gt; <br>
&lt;!DOCTYPE log4perl:configuration SYSTEM
&quot;log4perl.dtd&quot;&gt; <br>
&lt;log4perl:configuration
xmlns:log4perl=&quot;http://log4perl.sourceforge.net/&quot;
<br>
threshold=&quot;debug&quot;
oneMessagePerAppender=&quot;true&quot;&gt; <br>
&lt;log4perl:appender name=&quot;jabbender&quot;
class=&quot;Log::Dispatch::Jabber&quot;&gt; <br>
&lt;param&minus;nested name=&quot;login&quot;&gt; <br>
&lt;param name=&quot;hostname&quot;
value=&quot;a.jabber.server&quot;/&gt; <br>
&lt;param name=&quot;password&quot;
value=&quot;12345&quot;/&gt; <br>
&lt;param name=&quot;port&quot; value=&quot;5222&quot;/&gt;
<br>
&lt;param name=&quot;resource&quot;
value=&quot;logger&quot;/&gt; <br>
&lt;param name=&quot;username&quot;
value=&quot;bobjones&quot;/&gt; <br>
&lt;/param&minus;nested&gt; <br>
&lt;param name=&quot;to&quot;
value=&quot;bob@a.jabber.server&quot;/&gt; <br>
&lt;param&minus;text name=&quot;to&quot;&gt; <br>
mary@another.jabber.server <br>
&lt;/param&minus;text&gt; <br>
&lt;log4perl:layout
class=&quot;org.apache.log4j.PatternLayout&quot;&gt; <br>
&lt;param name=&quot;ConversionPattern&quot; value =
&quot;%K xx %G %U&quot;/&gt; <br>
&lt;cspec name=&quot;K&quot;&gt; <br>
sub { return sprintf &quot;%1x&quot;, $$} <br>
&lt;/cspec&gt; <br>
&lt;cspec name=&quot;G&quot;&gt; <br>
sub {return 'thisistheGcspec'} <br>
&lt;/cspec&gt; <br>
&lt;/log4perl:layout&gt; <br>
&lt;/log4perl:appender&gt; <br>
&lt;log4perl:appender name=&quot;DBAppndr2&quot;
class=&quot;Log::Log4perl::Appender::DBI&quot;&gt; <br>
&lt;param name=&quot;warp_message&quot;
value=&quot;0&quot;/&gt; <br>
&lt;param name=&quot;datasource&quot;
value=&quot;DBI:CSV:f_dir=t/tmp&quot;/&gt; <br>
&lt;param name=&quot;bufferSize&quot;
value=&quot;2&quot;/&gt; <br>
&lt;param name=&quot;password&quot; value=&quot;sub {
$ENV{PWD} }&quot;/&gt; <br>
&lt;param name=&quot;username&quot;
value=&quot;bobjones&quot;/&gt; <br>
&lt;param&minus;text name=&quot;sql&quot;&gt; <br>
INSERT INTO log4perltest <br>
(loglevel, message, shortcaller, thingid, <br>
category, pkg, runtime1, runtime2) <br>
VALUES <br>
(?,?,?,?,?,?,?,?) <br>
&lt;/param&minus;text&gt; <br>
&lt;param&minus;nested name=&quot;params&quot;&gt; <br>
&lt;param name=&quot;1&quot; value=&quot;%p&quot;/&gt; <br>
&lt;param name=&quot;3&quot; value=&quot;%5.5l&quot;/&gt;
<br>
&lt;param name=&quot;5&quot; value=&quot;%c&quot;/&gt; <br>
&lt;param name=&quot;6&quot; value=&quot;%C&quot;/&gt; <br>
&lt;/param&minus;nested&gt; <br>
&lt;layout
class=&quot;Log::Log4perl::Layout::NoopLayout&quot;/&gt;
<br>
&lt;/log4perl:appender&gt; <br>
&lt;category name=&quot;animal.dog&quot;&gt; <br>
&lt;priority value=&quot;info&quot;/&gt; <br>
&lt;appender&minus;ref ref=&quot;jabbender&quot;/&gt; <br>
&lt;appender&minus;ref ref=&quot;DBAppndr2&quot;/&gt; <br>
&lt;/category&gt; <br>
&lt;category name=&quot;plant&quot;&gt; <br>
&lt;priority value=&quot;debug&quot;/&gt; <br>
&lt;appender&minus;ref ref=&quot;DBAppndr2&quot;/&gt; <br>
&lt;/category&gt; <br>
&lt;PatternLayout&gt; <br>
&lt;cspec name=&quot;U&quot;&gt;&lt;![CDATA[ <br>
sub { <br>
return &quot;UID $&lt; GID $(&quot;; <br>
} <br>
]]&gt;&lt;/cspec&gt; <br>
&lt;/PatternLayout&gt; <br>
&lt;/log4perl:configuration&gt;</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This module
implements an <small>XML</small> config, complementing the
properties-style config described elsewhere.</p>

<h2>WHY
<a name="WHY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">&quot;Why would
I want my config in <small>XML</small> ?&quot; you ask.
Well, there are a couple reasons you might want to. Maybe
you have a personal preference for <small>XML.</small> Maybe
you manage your config with other tools that have an
affinity for <small>XML,</small> like XML-aware editors or
automated config generators. Or maybe (and this is the big
one) you don&rsquo;t like having to run your application
just to check the syntax of your config file.</p>

<p style="margin-left:11%; margin-top: 1em">By using an
<small>XML</small> config and referencing a
<small>DTD,</small> you can use a namespace-aware validating
parser to see if your <small>XML</small> config at least
follows the rules set in the <small>DTD.</small></p>

<h2>HOW
<a name="HOW"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To reference a
<small>DTD,</small> drop this in after the &lt;?xml...&gt;
declaration in your config file:</p>

<p style="margin-left:11%; margin-top: 1em">&lt;!DOCTYPE
log4perl:configuration SYSTEM
&quot;log4perl.dtd&quot;&gt;</p>

<p style="margin-left:11%; margin-top: 1em">That tells the
parser to validate your config against the
<small>DTD</small> in &quot;log4perl.dtd&quot;, which is
available in the xml/ directory of the log4perl
distribution. Note that you&rsquo;ll also need to grab the
log4j&minus;1.2.dtd from there as well, since the it&rsquo;s
included by log4perl.dtd.</p>


<p style="margin-left:11%; margin-top: 1em">Namespace-aware
validating parsers are not the norm in Perl. But the Xerces
project (http://xml.apache.org/xerces&minus;c/index.html
&minus;&minus;lots of binaries available, even rpm&rsquo;s)
does provide just such a parser that you can use like
this:</p>

<p style="margin-left:11%; margin-top: 1em">StdInParse
&minus;ns &minus;v &lt;
my&minus;log4perl&minus;config.xml</p>

<p style="margin-left:11%; margin-top: 1em">This module
itself does not use a validating parser, the obvious one
XML::DOM::ValParser doesn&rsquo;t seem to handle
namespaces.</p>

<h2>WHY TWO DTDs
<a name="WHY TWO DTDs"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The log4j
<small>DTD</small> is from the log4j project, they designed
it to handle their needs. log4perl has added some extensions
to the original log4j functionality which needed some
extensions to the log4j <small>DTD.</small> If you
aren&rsquo;t using these features then you can validate your
config against the log4j dtd and know that you&rsquo;re
using unadulterated log4j config tags.</p>

<p style="margin-left:11%; margin-top: 1em">The features
added by the log4perl dtd are: <br>
1 oneMessagePerAppender global setting</p>


<p style="margin-left:17%;">log4perl.oneMessagePerAppender=1</p>

<p style="margin-left:11%;">2 globally defined user
conversion specifiers</p>


<p style="margin-left:17%;">log4perl.PatternLayout.cspec.G=sub
{ return &quot;UID $&lt; GID $(&quot;; }</p>

<p style="margin-left:11%;">3 appender-local custom
conversion specifiers</p>


<p style="margin-left:17%;">log4j.appender.appndr1.layout.cspec.K
= sub {return sprintf &quot;%1x&quot;, $$ }</p>

<p style="margin-left:11%;">4 nested options</p>

<p style="margin-left:17%;">log4j.appender.jabbender =
Log::Dispatch::Jabber <br>
#(note how these are nested under 'login') <br>
log4j.appender.jabbender.login.hostname = a.jabber.server
<br>
log4j.appender.jabbender.login.port = 5222 <br>
log4j.appender.jabbender.login.username = bobjones</p>

<p style="margin-left:11%;">5 the log4perl&minus;specific
filters, see Log::Log4perl::Filter, lots of <br>
examples in t/044XML&minus;Filter.t, here&rsquo;s a short
one:</p>

<p style="margin-left:17%;">&lt;?xml
version=&quot;1.0&quot;
encoding=&quot;UTF&minus;8&quot;?&gt; <br>
&lt;!DOCTYPE log4perl:configuration SYSTEM
&quot;log4perl.dtd&quot;&gt; <br>
&lt;log4perl:configuration
xmlns:log4perl=&quot;http://log4perl.sourceforge.net/&quot;&gt;
<br>
&lt;appender name=&quot;A1&quot;
class=&quot;Log::Log4perl::Appender::TestBuffer&quot;&gt;
<br>
&lt;layout
class=&quot;Log::Log4perl::Layout::SimpleLayout&quot;/&gt;
<br>
&lt;filter
class=&quot;Log::Log4perl::Filter::Boolean&quot;&gt; <br>
&lt;param name=&quot;logic&quot; value=&quot;!Match3
&amp;amp;&amp;amp; (Match1 || Match2)&quot;/&gt; <br>
&lt;/filter&gt; <br>
&lt;/appender&gt; <br>
&lt;appender name=&quot;A2&quot;
class=&quot;Log::Log4perl::Appender::TestBuffer&quot;&gt;
<br>
&lt;layout
class=&quot;Log::Log4perl::Layout::SimpleLayout&quot;/&gt;
<br>
&lt;filter&minus;ref id=&quot;Match1&quot;/&gt; <br>
&lt;/appender&gt; <br>
&lt;log4perl:filter name=&quot;Match1&quot; value=&quot;sub
{ /let this through/ }&quot; /&gt; <br>
&lt;log4perl:filter name=&quot;Match2&quot;&gt; <br>
sub { <br>
/and that, too/ <br>
} <br>
&lt;/log4perl:filter&gt; <br>
&lt;log4perl:filter name=&quot;Match3&quot;
class=&quot;Log::Log4perl::Filter::StringMatch&quot;&gt;
<br>
&lt;param name=&quot;StringToMatch&quot;
value=&quot;suppress&quot;/&gt; <br>
&lt;param name=&quot;AcceptOnMatch&quot;
value=&quot;true&quot;/&gt; <br>
&lt;/log4perl:filter&gt; <br>
&lt;log4perl:filter name=&quot;MyBoolean&quot;
class=&quot;Log::Log4perl::Filter::Boolean&quot;&gt; <br>
&lt;param name=&quot;logic&quot; value=&quot;!Match3
&amp;amp;&amp;amp; (Match1 || Match2)&quot;/&gt; <br>
&lt;/log4perl:filter&gt; <br>
&lt;root&gt; <br>
&lt;priority value=&quot;info&quot;/&gt; <br>
&lt;appender&minus;ref ref=&quot;A1&quot;/&gt; <br>
&lt;/root&gt; <br>
&lt;/log4perl:configuration&gt;</p>

<p style="margin-left:11%; margin-top: 1em">So we needed to
extend the log4j dtd to cover these additions. Now I could
have just taken a &rsquo;steal this code&rsquo; approach and
mixed parts of the log4j dtd into a log4perl dtd, but that
would be cut-n-paste programming. So I&rsquo;ve used
namespaces and</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="37%">


<p>replaced three elements:</p></td>
<td width="46%">
</td></tr>
</table>


<p style="margin-left:17%;">&lt;log4perl:configuration&gt;</p>

<p style="margin-left:23%;">handles #1) and accepts
&lt;PatternLayout&gt;</p>

<p style="margin-left:17%;">&lt;log4perl:appender&gt;</p>

<p style="margin-left:23%;">accepts
&lt;param&minus;nested&gt; and &lt;param&minus;text&gt;</p>

<p style="margin-left:17%;">&lt;log4perl:layout&gt;</p>

<p style="margin-left:23%;">accepts custom cspecs for
#3)</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>added a &lt;param&minus;nested&gt; element
(complementing the &lt;param&gt; element)</p></td></tr>
</table>

<p style="margin-left:17%;">to handle #4)</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p style="margin-top: 1em">added a root
&lt;PatternLayout&gt; element to handle #2)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="5%"></td>
<td width="83%">


<p>added &lt;param&minus;text&gt; which lets you put things
like perl code</p></td></tr>
</table>

<p style="margin-left:17%;">into escaped
<small>CDATA</small> between the tags, so you don&rsquo;t
have to worry <br>
about escaping characters and quotes</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="5%"></td>
<td width="20%">


<p style="margin-top: 1em">added &lt;cspec&gt;</p></td>
<td width="63%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">See the
examples up in the &quot; <small>SYNOPSIS&quot;</small> for
how all that gets used.</p>

<h2>WHY NAMESPACES
<a name="WHY NAMESPACES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">I liked the
idea of using the log4j <small>DTD</small> <i>in situ</i>,
so I used namespaces to extend it. If you really don&rsquo;t
like having to type &lt;log4perl:appender&gt; instead of
just &lt;appender&gt;, you can make your own
<small>DTD</small> combining the two DTDs and getting rid of
the namespace prefixes. Then you can validate against that,
and log4perl should accept it just fine.</p>

<h2>VARIABLE SUBSTITUTION
<a name="VARIABLE SUBSTITUTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This supports
variable substitution like &quot;${foobar}&quot; in text and
in attribute values except for appender-ref. If an
environment variable is defined for that name, its value is
substituted. So you can do stuff like</p>

<p style="margin-left:11%; margin-top: 1em">&lt;param
name=&quot;${hostname}&quot;
value=&quot;${hostnameval}.foo.com&quot;/&gt; <br>
&lt;param&minus;text
name=&quot;to&quot;&gt;${currentsysadmin}@foo.com&lt;/param&minus;text&gt;</p>

<h2>REQUIRES
<a name="REQUIRES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To use this
module you need <small>XML::DOM</small> installed.</p>

<p style="margin-left:11%; margin-top: 1em">To use the
log4perl.dtd, you&rsquo;ll have to reference it in your
<small>XML</small> config, and you&rsquo;ll also need to
note that log4perl.dtd references the log4j dtd as
&quot;log4j&minus;1.2.dtd&quot;, so your validator needs to
be able to find that file as well. If you don&rsquo;t like
having to schlep two files around, feel free to dump the
contents of &quot;log4j&minus;1.2.dtd&quot; into your
&quot;log4perl.dtd&quot; file.</p>

<h2>CAVEATS
<a name="CAVEATS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">You can&rsquo;t
mix a multiple param-nesteds with the same name, I&rsquo;m
going to leave that for now, there&rsquo;s presently no need
for a list of structs in the config.</p>

<h2>CHANGES
<a name="CHANGES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">0.03 2/26/2003
Added support for log4perl extensions to the log4j dtd</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">t/038XML&minus;DOM1.t,
t/039XML&minus;DOM2.t for examples</p>


<p style="margin-left:11%; margin-top: 1em">xml/log4perl.dtd,
xml/log4j&minus;1.2.dtd</p>


<p style="margin-left:11%; margin-top: 1em">Log::Log4perl::Config</p>


<p style="margin-left:11%; margin-top: 1em">Log::Log4perl::Config::PropertyConfigurator</p>


<p style="margin-left:11%; margin-top: 1em">Log::Log4perl::Config::LDAPConfigurator
(coming soon!)</p>

<p style="margin-left:11%; margin-top: 1em">The code is
brazenly modeled on log4j&rsquo;s DOMConfigurator class, (by
Christopher Taylor, Ceki
G&Atilde;&frac14;lc&Atilde;&frac14;, and Anders Kristensen)
and any perceived similarity is not coincidental.</p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright
2002&minus;2013 by Mike Schilli &lt;m@perlmeister.com&gt;
and Kevin Goess &lt;cpan@goess.org&gt;.</p>

<p style="margin-left:11%; margin-top: 1em">This library is
free software; you can redistribute it and/or modify it
under the same terms as Perl itself.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Please
contribute patches to the project on Github:</p>


<p style="margin-left:11%; margin-top: 1em">http://github.com/mschilli/log4perl</p>

<p style="margin-left:11%; margin-top: 1em">Send bug
reports or requests for enhancements to the authors via
our</p>

<p style="margin-left:11%; margin-top: 1em"><small>MAILING
LIST</small> (questions, bug reports, suggestions/patches):
log4perl&minus;devel@lists.sourceforge.net</p>

<p style="margin-left:11%; margin-top: 1em">Authors (please
contact them via the list above, not directly): Mike Schilli
&lt;m@perlmeister.com&gt;, Kevin Goess
&lt;cpan@goess.org&gt;</p>

<p style="margin-left:11%; margin-top: 1em">Contributors
(in alphabetical order): Ateeq Altaf, Cory Bennett, Jens
Berthold, Jeremy Bopp, Hutton Davidson, Chris R. Donnelly,
Matisse Enzer, Hugh Esco, Anthony Foiani, James FitzGibbon,
Carl Franks, Dennis Gregorovic, Andy Grundman, Paul
Harrington, Alexander Hartmaier David Hull, Robert Jacobson,
Jason Kohles, Jeff Macdonald, Markus Peter, Brett Rann,
Peter Rabbitson, Erik Selberg, Aaron Straup Cope, Lars
Thegler, David Viner, Mac Yang.</p>
<hr>
</body>
</html>
