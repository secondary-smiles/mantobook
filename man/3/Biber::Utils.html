<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:54:20 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>Biber::Utils</title>

</head>
<body>
<h1>Biber::Utils</h1>



<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Biber::Utils
&minus; Various utility subs used in Biber</p>

<h2>EXPORT
<a name="EXPORT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">All functions
are exported by default.</p>

<h2>FUNCTIONS
<a name="FUNCTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>glob_data_file</b>
<br>
Expands a data file glob to a list of filenames</p>


<p style="margin-left:11%; margin-top: 1em"><b>slurp_switchr</b>
<br>
Use different read encoding/slurp interfaces for Windows due
to its <br>
horrible legacy codepage system</p>


<p style="margin-left:11%; margin-top: 1em"><b>slurp_switchw</b>
<br>
Use different write encoding/slurp interfaces for Windows
due to its <br>
horrible legacy codepage system</p>


<p style="margin-left:11%; margin-top: 1em"><b>locate_data_file</b>
<br>
Searches for a data file by <br>
The exact path if the filename is absolute <br>
In the input_directory, if defined <br>
In the output_directory, if defined <br>
Relative to the current directory <br>
In the same directory as the control file <br>
Using kpsewhich, if available</p>

<p style="margin-left:11%; margin-top: 1em">Check existence
of NFC/NFD file variants and return correct one. <br>
Account for windows file encodings</p>


<p style="margin-left:11%; margin-top: 1em"><b>check_empty</b>
<br>
Wrapper around empty check to deal with Win32 Unicode
filenames</p>


<p style="margin-left:11%; margin-top: 1em"><b>check_exists</b>
<br>
Wrapper around exists check to deal with Win32 Unicode
filenames</p>


<p style="margin-left:11%; margin-top: 1em"><b>biber_warn</b>
<br>
Wrapper around various warnings bits and pieces. <br>
Add warning to the list of .bbl warnings and the master list
of warnings</p>


<p style="margin-left:11%; margin-top: 1em"><b>biber_error</b>
<br>
Wrapper around error logging <br>
Forces an exit.</p>


<p style="margin-left:11%; margin-top: 1em"><b>makenamesid</b>
<br>
Given a Biber::Names object, return an underscore normalised
concatenation of all of the full name strings.</p>


<p style="margin-left:11%; margin-top: 1em"><b>makenameid</b>
<br>
Given a Biber::Name object, return an underscore normalised
concatenation of the full name strings.</p>


<p style="margin-left:11%; margin-top: 1em"><b>latex_recode_output</b>
<br>
Tries to convert UTF&minus;8 to TeX macros in passed
string</p>


<p style="margin-left:11%; margin-top: 1em"><b>strip_noinit</b>
<br>
Removes elements which are not to be considered during
initials generation <br>
in names</p>


<p style="margin-left:11%; margin-top: 1em"><b>strip_nosort</b>
<br>
Removes elements which are not to be used in sorting a name
from a string</p>


<p style="margin-left:11%; margin-top: 1em"><b>strip_nonamestring</b>
<br>
Removes elements which are not to be used in certain
name&minus;related operations like: <br>
* fullhash generation <br>
* uniquename generation <br>
from a name</p>


<p style="margin-left:11%; margin-top: 1em"><b>normalise_string_label</b>
<br>
Remove some things from a string for label generation.
Don&rsquo;t strip \p{Dash} as this is needed to process
compound names or label generation.</p>


<p style="margin-left:11%; margin-top: 1em"><b>normalise_string_sort</b>
<br>
Removes LaTeX macros, and all punctuation, symbols,
separators as well as leading and trailing whitespace for
sorting strings. Control chars don&rsquo;t need to be
stripped as they are completely ignorable in
<small>DUCET</small></p>


<p style="margin-left:11%; margin-top: 1em"><b>normalise_string_bblxml</b>
<br>
Some string normalisation for bblxml output</p>


<p style="margin-left:11%; margin-top: 1em"><b>normalise_string</b>
<br>
Removes LaTeX macros, and all punctuation, symbols,
separators and control characters, as well as leading and
trailing whitespace for sorting strings. Only decodes LaTeX
character macros into Unicode if output is
<small>UTF&minus;8</small></p>


<p style="margin-left:11%; margin-top: 1em"><b>normalise_string_common</b>
<br>
Common bit for normalisation</p>


<p style="margin-left:11%; margin-top: 1em"><b>normalise_string_hash</b>
<br>
Normalise strings used for hashes. We collapse LaTeX macros
into a vestige <br>
so that hashes are unique between things like: <br>
Smith <br>
{\v S}mith <br>
we replace macros like this to preserve their vestiges: <br>
\v S &minus;&gt; v: <br>
\&quot; &minus;&gt; 34:</p>


<p style="margin-left:11%; margin-top: 1em"><b>normalise_string_underscore</b>
<br>
Like normalise_string, but also substitutes ~ and whitespace
with underscore.</p>


<p style="margin-left:11%; margin-top: 1em"><b>escape_label</b>
<br>
Escapes a few special character which might be used in
labels</p>


<p style="margin-left:11%; margin-top: 1em"><b>unescape_label</b>
<br>
Unscapes a few special character which might be used in
label but which need <br>
sorting without escapes</p>


<p style="margin-left:11%; margin-top: 1em"><b>reduce_array</b>
<br>
reduce_array(\@a, \@b) returns all elements in @a that are
not in @b</p>


<p style="margin-left:11%; margin-top: 1em"><b>remove_outer</b>
<br>
Remove surrounding curly brackets: <br>
'{string}' &minus;&gt; 'string' <br>
but not <br>
'{string} {string}' &minus;&gt; 'string} {string' <br>
Return (boolean if stripped, string)</p>


<p style="margin-left:11%; margin-top: 1em"><b>has_outer</b>
<br>
Return (boolean if surrounded in braces</p>


<p style="margin-left:11%; margin-top: 1em"><b>add_outer</b>
<br>
Add surrounding curly brackets: <br>
'string' &minus;&gt; '{string}'</p>

<p style="margin-left:11%; margin-top: 1em"><b>ucinit</b>
<br>
upper case of initial letters in a string</p>


<p style="margin-left:11%; margin-top: 1em"><b>is_undef</b>
<br>
Checks for undefness of arbitrary things, including <br>
composite method chain calls which don't reliably work <br>
with defined() (see perldoc for defined()) <br>
This works because we are just testing the value passed <br>
to this sub. So, for example, this is randomly unreliable
<br>
even if the resulting value of the arg to defined() is
&quot;undef&quot;: <br>
defined($thing&minus;&gt;method($arg)&minus;&gt;method) <br>
whereas: <br>
is_undef($thing&minus;&gt;method($arg)&minus;&gt;method)
<br>
works since we only test the return value of all the methods
<br>
with defined()</p>

<p style="margin-left:11%; margin-top: 1em"><b>is_def</b>
<br>
Checks for definedness in the same way as is_undef()</p>


<p style="margin-left:11%; margin-top: 1em"><b>is_undef_or_null</b>
<br>
Checks for undef or nullness (see is_undef() above)</p>


<p style="margin-left:11%; margin-top: 1em"><b>is_def_and_notnull</b>
<br>
Checks for def and unnullness (see is_undef() above)</p>


<p style="margin-left:11%; margin-top: 1em"><b>is_def_and_null</b>
<br>
Checks for def and nullness (see is_undef() above)</p>

<p style="margin-left:11%; margin-top: 1em"><b>is_null</b>
<br>
Checks for nullness</p>


<p style="margin-left:11%; margin-top: 1em"><b>is_notnull</b>
<br>
Checks for notnullness</p>


<p style="margin-left:11%; margin-top: 1em"><b>is_notnull_scalar</b>
<br>
Checks for notnullness of a scalar</p>


<p style="margin-left:11%; margin-top: 1em"><b>is_notnull_array</b>
<br>
Checks for notnullness of an array (passed by ref)</p>


<p style="margin-left:11%; margin-top: 1em"><b>is_notnull_hash</b>
<br>
Checks for notnullness of an hash (passed by ref)</p>


<p style="margin-left:11%; margin-top: 1em"><b>is_notnull_object</b>
<br>
Checks for notnullness of an object (passed by ref)</p>


<p style="margin-left:11%; margin-top: 1em"><b>stringify_hash</b>
<br>
Turns a hash into a string of keys and values</p>


<p style="margin-left:11%; margin-top: 1em"><b>normalise_utf8</b>
<br>
Normalise any UTF&minus;8 encoding string immediately to
exactly what we want <br>
We want the strict perl utf8 &quot;UTF&minus;8&quot;</p>

<p style="margin-left:11%; margin-top: 1em"><b>inits</b>
<br>
We turn the initials into an array so we can be flexible
with them later <br>
The tie here is used only so we know what to split on. We
don't want to make <br>
any typesetting decisions in Biber, like what to use to join
initials so on <br>
output to the .bbl, we only use BibLaTeX macros.</p>


<p style="margin-left:11%; margin-top: 1em"><b>join_name</b>
<br>
Replace all join typsetting elements in a name part (space,
ties) with BibLaTeX macros <br>
so that typesetting decisions are made in BibLaTeX, not
hard&minus;coded in Biber</p>


<p style="margin-left:11%; margin-top: 1em"><b>filter_entry_options</b>
<br>
Process any per_entry option transformations which are
necessary on output</p>

<p style="margin-left:11%; margin-top: 1em"><b>imatch</b>
<br>
Do an interpolating (neg)match using a match RE and a string
passed in as variables <br>
Using /g on matches so that $1,$2 etc. can be populated from
repeated matches of <br>
same capture group as well as different groups</p>


<p style="margin-left:11%; margin-top: 1em"><b>ireplace</b>
<br>
Do an interpolating match/replace using a match RE,
replacement RE <br>
and string passed in as variables</p>


<p style="margin-left:11%; margin-top: 1em"><b>validate_biber_xml</b>
<br>
Validate a biber/biblatex XML metadata file against an RNG
XML schema</p>


<p style="margin-left:11%; margin-top: 1em"><b>map_boolean</b>
<br>
Convert booleans between strings and numbers. Because
standard XML &quot;boolean&quot; <br>
datatype considers &quot;true&quot; and &quot;1&quot; the
same etc.</p>


<p style="margin-left:11%; margin-top: 1em"><b>process_entry_options</b>
<br>
Set per&minus;entry options</p>


<p style="margin-left:11%; margin-top: 1em"><b>merge_entry_options</b>
<br>
Merge entry options, dealing with conflicts</p>


<p style="margin-left:11%; margin-top: 1em"><b>expand_option_input</b>
<br>
Expand options such as meta&minus;options coming from
biblatex</p>


<p style="margin-left:11%; margin-top: 1em"><b>parse_date_range</b>
<br>
Parse of ISO8601 date range</p>


<p style="margin-left:11%; margin-top: 1em"><b>parse_date_unspecified</b>
<br>
Parse of ISO8601&minus;2:2016 4.3 unspecified format into
date range <br>
Returns range plus specification of granularity of
unspecified</p>


<p style="margin-left:11%; margin-top: 1em"><b>parse_date_start</b>
<br>
Convenience wrapper</p>


<p style="margin-left:11%; margin-top: 1em"><b>parse_date_end</b>
<br>
Convenience wrapper</p>


<p style="margin-left:11%; margin-top: 1em"><b>parse_date</b>
<br>
Parse of iso8601&minus;2 dates</p>


<p style="margin-left:11%; margin-top: 1em"><b>date_monthday</b>
<br>
Force month/day to ISO8601&minus;2:2016 format with leading
zero</p>


<p style="margin-left:11%; margin-top: 1em"><b>biber_decode_utf8</b>
<br>
Perform NFD form conversion as well as UTF&minus;8
conversion. Used to normalize <br>
bibtex input as the T::B interface doesn't allow a neat
whole file slurping.</p>

<p style="margin-left:11%; margin-top: 1em"><b>out</b> <br>
Output to target. Outputs NFC UTF&minus;8 if output is
UTF&minus;8</p>


<p style="margin-left:11%; margin-top: 1em"><b>process_comment</b>
<br>
Fix up some problems with comments after being processed by
btparse</p>


<p style="margin-left:11%; margin-top: 1em"><b>locale2bcp47</b>
<br>
Map babel/polyglossia language options to a sensible CLDR
(bcp47) locale default <br>
Return input string if there is no mapping</p>


<p style="margin-left:11%; margin-top: 1em"><b>bcp472locale</b>
<br>
Map CLDR (bcp47) locale to a babel/polyglossia locale <br>
Return input string if there is no mapping</p>


<p style="margin-left:11%; margin-top: 1em"><b>rangelen</b>
<br>
Calculate the length of a range field <br>
Range fields are an array ref of two&minus;element array
refs [range_start, range_end] <br>
range_end can be be empty for open&minus;ended range or
undef <br>
Deals with Unicode and ASCII roman numerals via the magic of
Unicode NFKD form <br>
m&minus;n &minus;&gt; [m, n] <br>
m &minus;&gt; [m, undef] <br>
m&minus; &minus;&gt; [m, ''] <br>
&minus;n &minus;&gt; ['', n] <br>
&minus; &minus;&gt; ['', undef]</p>


<p style="margin-left:11%; margin-top: 1em"><b>match_indices</b>
<br>
Return array ref of array refs of matches and start indices
of matches <br>
for provided array of compiled regexps into string</p>


<p style="margin-left:11%; margin-top: 1em"><b>parse_range</b>
<br>
Parses a range of values into a two&minus;value array ref.
<br>
Ranges with no starting value default to &quot;1&quot; <br>
Ranges can be open&minus;ended and it's up to surrounding
code to interpret this <br>
Ranges can be single figures which is shorthand for
1&minus;x</p>


<p style="margin-left:11%; margin-top: 1em"><b>strip_annotation</b>
<br>
Removes annotation marker from a field name</p>


<p style="margin-left:11%; margin-top: 1em"><b>parse_range_alt</b>
<br>
Parses a range of values into a two&minus;value array ref.
<br>
Either start or end can be undef and it's up to surrounding
code to interpret this</p>


<p style="margin-left:11%; margin-top: 1em"><b>maploopreplace</b>
<br>
Replace loop markers with values.</p>


<p style="margin-left:11%; margin-top: 1em"><b>get_transliterator</b>
<br>
Get a ref to a transliterator for the given from/to <br>
We are abstracting this in this way because it is not clear
what the future <br>
of the transliteration library is. We want to be able to
switch.</p>


<p style="margin-left:11%; margin-top: 1em"><b>call_transliterator</b>
<br>
Run a transliterator on passed text. Hides call semantics of
transliterator <br>
so we can switch engine in the future.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Philip Kime
&quot;&lt;philip at kime.org.uk&gt;&quot;</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Please report
any bugs or feature requests on our Github tracker at
&lt;https://github.com/plk/biber/issues&gt;.</p>

<h2>COPYRIGHT &amp; LICENSE
<a name="COPYRIGHT &amp; LICENSE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright
2012&minus;2023 Philip Kime, all rights reserved.</p>

<p style="margin-left:11%; margin-top: 1em">This module is
free software. You can redistribute it and/or modify it
under the terms of the Artistic License 2.0.</p>

<p style="margin-left:11%; margin-top: 1em">This program is
distributed in the hope that it will be useful, but without
any warranty; without even the implied warranty of
merchantability or fitness for a particular purpose.</p>
<hr>
</body>
</html>
