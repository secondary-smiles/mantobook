<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:55:46 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PCAP_DUMP_OPEN</title>

</head>
<body>
<h1>pcap_dump_fopen</h1>



<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">pcap_dump_open,
pcap_dump_open_append, pcap_dump_fopen &minus; open a file
to which to write packets</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;pcap/pcap.h&gt;</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>pcap_dumper_t
*pcap_dump_open(pcap_t *p, const char *fname); <br>
pcap_dumper_t *pcap_dump_open_append(pcap_t *p, const char
*fname); <br>
pcap_dumper_t *pcap_dump_fopen(pcap_t *p, FILE *fp);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pcap_dump_open</b>()
is called to open a &lsquo;&lsquo;savefile&rsquo;&rsquo; for
writing. <i>fname</i> specifies the name of the file to
open. The file will have the same format as those used by
<b>tcpdump</b>(1) and <b>tcpslice</b>(1). If the file does
not exist, it will be created; if the file exists, it will
be truncated and overwritten. The name &quot;-&quot; is a
synonym for <b>stdout</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pcap_dump_fopen</b>()
is called to write data to an existing open stream
<i>fp</i>; this stream will be closed by a subsequent call
to <b>pcap_dump_close</b>(3PCAP). The stream is assumed to
be at the beginning of a file that has been newly created or
truncated, so that writes will start at the beginning of the
file. Note that on Windows, that stream should be opened in
binary mode.</p>

<p style="margin-left:11%; margin-top: 1em"><i>p</i> is a
capture or &lsquo;&lsquo;savefile&rsquo;&rsquo; handle
returned by an earlier call to <b>pcap_create</b>(3PCAP) and
activated by an earlier call to <b>pcap_activate</b>(3PCAP),
or returned by an earlier call to
<b>pcap_open_offline</b>(3PCAP),
<b>pcap_open_live</b>(3PCAP), or
<b>pcap_open_dead</b>(3PCAP). The time stamp precision,
link-layer type, and snapshot length from <i>p</i> are used
as the link-layer type and snapshot length of the output
file.</p>


<p style="margin-left:11%; margin-top: 1em"><b>pcap_dump_open_append</b>()
is like <b>pcap_dump_open</b>() but, if the file already
exists, and is a pcap file with the same byte order as the
host opening the file, and has the same time stamp
precision, link-layer header type, and snapshot length as
<i>p</i>, it will write new packets at the end of the
file.</p>

<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">A pointer to a
<b>pcap_dumper_t</b> structure to use in subsequent
<b>pcap_dump</b>(3PCAP) and <b>pcap_dump_close</b>(3PCAP)
calls is returned on success. <b>NULL</b> is returned on
failure. If <b>NULL</b> is returned,
<b>pcap_geterr</b>(3PCAP) can be used to get the error
text.</p>

<h2>BACKWARD COMPATIBILITY
<a name="BACKWARD COMPATIBILITY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>pcap_dump_open_append</b>() function became available in
libpcap release 1.7.2. In previous releases, there is no
support for appending packets to an existing savefile.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pcap</b>(3PCAP),
<b>pcap-savefile</b>(5)</p>
<hr>
</body>
</html>
