<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:55:46 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PCAP_SET_PROTOCOL_LINUX</title>

</head>
<body>
<h1>pcap_set_protocol_linux</h1>



<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">pcap_set_protocol_linux
&minus; set capture protocol for a not-yet-activated capture
handle</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;pcap/pcap.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
pcap_set_protocol_linux(pcap_t *p, int protocol);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">On network
interface devices on Linux, <b>pcap_set_protocol_linux</b>()
sets the protocol to be used in the <b>socket</b>(2) call to
create a capture socket when the handle is activated. The
argument is a link-layer protocol value, such as the values
in the <b>&lt;linux/if_ether.h&gt;</b> header file,
specified in host byte order. If <i>protocol</i> is
non-zero, packets of that protocol will be captured when the
handle is activated, otherwise, all packets will be
captured. This function is only provided on Linux, and, if
it is used on any device other than a network interface, it
will have no effect.</p>

<p style="margin-left:11%; margin-top: 1em">It should not
be used in portable code; instead, a filter should be
specified with <b>pcap_setfilter</b>(3PCAP).</p>

<p style="margin-left:11%; margin-top: 1em">If a given
network interface provides a standard link-layer header,
with a standard packet type, but provides some packet types
with a different socket-layer protocol type from the one in
the link-layer header, that packet type cannot be filtered
with a filter specified with <b>pcap_setfilter</b>() but can
be filtered by specifying the socket-layer protocol type
using <b>pcap_set_protocol_linux</b>().</p>

<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pcap_set_protocol_linux</b>()
returns <b>0</b> on success or <b>PCAP_ERROR_ACTIVATED</b>
if called on a capture handle that has been activated.</p>

<h2>BACKWARD COMPATIBILITY
<a name="BACKWARD COMPATIBILITY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This function
became available in libpcap release 1.9.0.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pcap</b>(3PCAP),
<b>pcap_create</b>(3PCAP), <b>pcap_activate</b>(3PCAP)</p>
<hr>
</body>
</html>
