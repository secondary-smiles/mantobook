<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:55:29 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>libalpm_databases</title>

</head>
<body>
<h1>libalpm_databases</h1>



<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">libalpm_databases
&minus; Database</p>

<p style="margin-left:11%; margin-top: 1em">&minus;
Functions to query and manipulate the database of
libalpm.</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Typedefs</b></p>

<p style="margin-left:17%;">typedef struct __alpm_db_t
<b>alpm_db_t</b> <br>
A database.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Enumerations</b></p>

<p style="margin-left:17%;">enum <b>alpm_db_usage_t</b> {
<b>ALPM_DB_USAGE_SYNC</b> = 1, <b>ALPM_DB_USAGE_SEARCH</b> =
(1 &lt;&lt; 1), <b>ALPM_DB_USAGE_INSTALL</b> = (1 &lt;&lt;
2), <b>ALPM_DB_USAGE_UPGRADE</b> = (1 &lt;&lt; 3),
<b>ALPM_DB_USAGE_ALL</b> = (1 &lt;&lt; 4) - 1 } <br>
The usage level of a database.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Functions</b></p>

<p style="margin-left:17%;"><b>alpm_db_t</b> *
<b>alpm_get_localdb</b> (<b>alpm_handle_t</b> *handle) <br>
Get the database of locally installed packages. <b><br>
alpm_list_t</b> * <b>alpm_get_syncdbs</b>
(<b>alpm_handle_t</b> *handle) <br>
Get the list of sync databases. <b><br>
alpm_db_t</b> * <b>alpm_register_syncdb</b>
(<b>alpm_handle_t</b> *handle, const char *treename, int
level) <br>
Register a sync database of packages. <br>
int <b>alpm_unregister_all_syncdbs</b> (<b>alpm_handle_t</b>
*handle) <br>
Unregister all package databases. <br>
int <b>alpm_db_unregister</b> (<b>alpm_db_t</b> *db) <br>
Unregister a package database. <br>
const char * <b>alpm_db_get_name</b> (const <b>alpm_db_t</b>
*db) <br>
Get the name of a package database. <br>
int <b>alpm_db_get_siglevel</b> (<b>alpm_db_t</b> *db) <br>
Get the signature verification level for a database. <br>
int <b>alpm_db_get_valid</b> (<b>alpm_db_t</b> *db) <br>
Check the validity of a database. <br>
int <b>alpm_db_update</b> (<b>alpm_handle_t</b> *handle,
<b>alpm_list_t</b> *dbs, int force) <br>
Update package databases. <b><br>
alpm_pkg_t</b> * <b>alpm_db_get_pkg</b> (<b>alpm_db_t</b>
*db, const char *name) <br>
Get a package entry from a package database. <b><br>
alpm_list_t</b> * <b>alpm_db_get_pkgcache</b>
(<b>alpm_db_t</b> *db) <br>
Get the package cache of a package database. <b><br>
alpm_group_t</b> * <b>alpm_db_get_group</b>
(<b>alpm_db_t</b> *db, const char *name) <br>
Get a group entry from a package database. <b><br>
alpm_list_t</b> * <b>alpm_db_get_groupcache</b>
(<b>alpm_db_t</b> *db) <br>
Get the group cache of a package database. <br>
int <b>alpm_db_search</b> (<b>alpm_db_t</b> *db, const
<b>alpm_list_t</b> *needles, <b>alpm_list_t</b> **ret) <br>
Searches a database with regular expressions.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Server
accessors</b></p>

<p style="margin-left:17%;"><b>alpm_list_t</b> *
<b>alpm_db_get_servers</b> (const <b>alpm_db_t</b> *db) <br>
Get the list of servers assigned to this db. <br>
int <b>alpm_db_set_servers</b> (<b>alpm_db_t</b> *db,
<b>alpm_list_t</b> *servers) <br>
Sets the list of servers for the database to use. <br>
int <b>alpm_db_add_server</b> (<b>alpm_db_t</b> *db, const
char *url) <br>
Add a download server to a database. <br>
int <b>alpm_db_remove_server</b> (<b>alpm_db_t</b> *db,
const char *url) <br>
Remove a download server from a database.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Usage
accessors</b></p>

<p style="margin-left:17%;">int <b>alpm_db_set_usage</b>
(<b>alpm_db_t</b> *db, int usage) <br>
Sets the usage of a database. <br>
int <b>alpm_db_get_usage</b> (<b>alpm_db_t</b> *db, int
*usage) <br>
Gets the usage of a database.</p>

<h2>Detailed Description
<a name="Detailed Description"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Functions to
query and manipulate the database of libalpm.</p>

<h2>Typedef Documentation
<a name="Typedef Documentation"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>typedef
struct __alpm_db_t alpm_db_t</b> <br>
A database. A database is a container that stores metadata
about packages.</p>

<p style="margin-left:11%; margin-top: 1em">A database can
be located on the local filesystem or on a remote
server.</p>

<p style="margin-left:11%; margin-top: 1em">To use a
database, it must first be registered via
<b>alpm_register_syncdb</b>. If the database is already
present in dbpath then it will be usable. Otherwise, the
database needs to be downloaded using <b>alpm_db_update</b>.
Even if the source of the database is the local
filesystem.</p>

<p style="margin-left:11%; margin-top: 1em">After this, the
database can be used to query packages and groups. Any
packages or groups from the database will continue to be
owned by the database and do not need to be freed by the
user. They will be freed when the database is
unregistered.</p>

<p style="margin-left:11%; margin-top: 1em">Databases are
automatically unregistered when the <b>alpm_handle_t</b> is
released.</p>

<h2>Enumeration Type Documentation
<a name="Enumeration Type Documentation"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>enum
alpm_db_usage_t</b> <br>
The usage level of a database.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Enumerator</b>
<i><br>
ALPM_DB_USAGE_SYNC</i></p>

<p style="margin-left:22%;">Enable refreshes for this
database.</p>


<p style="margin-left:11%;"><i>ALPM_DB_USAGE_SEARCH</i></p>

<p style="margin-left:22%;">Enable search for this
database.</p>


<p style="margin-left:11%;"><i>ALPM_DB_USAGE_INSTALL</i></p>

<p style="margin-left:22%;">Enable installing packages from
this database.</p>


<p style="margin-left:11%;"><i>ALPM_DB_USAGE_UPGRADE</i></p>

<p style="margin-left:22%;">Enable sysupgrades with this
database.</p>

<p style="margin-left:11%;"><i>ALPM_DB_USAGE_ALL</i></p>

<p style="margin-left:22%;">Enable all usage levels.</p>

<h2>Function Documentation
<a name="Function Documentation"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_db_add_server (alpm_db_t * db, const char * url)</b>
<br>
Add a download server to a database.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> database pointer
<i><br>
url</i> url of the server</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">0 on success, -1 on error
(pm_errno is set accordingly)</p>


<p style="margin-left:11%; margin-top: 1em"><b>alpm_group_t
* alpm_db_get_group (alpm_db_t * db, const char * name)</b>
<br>
Get a group entry from a package database. Looking up a
group is O(1) and will be significantly faster than
iterating over the groupcahe.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database to get the group from <i><br>
name</i> of the group</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">the groups entry on success,
NULL on error</p>

<p style="margin-left:11%; margin-top: 1em"><b>alpm_list_t
* alpm_db_get_groupcache (alpm_db_t * db)</b> <br>
Get the group cache of a package database.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database to get the group from</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">the list of groups on success,
NULL on error</p>

<p style="margin-left:11%; margin-top: 1em"><b>const char *
alpm_db_get_name (const alpm_db_t * db)</b> <br>
Get the name of a package database.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">the name of the package
database, NULL on error</p>

<p style="margin-left:11%; margin-top: 1em"><b>alpm_pkg_t *
alpm_db_get_pkg (alpm_db_t * db, const char * name)</b> <br>
Get a package entry from a package database. Looking up a
package is O(1) and will be significantly faster than
iterating over the pkgcahe.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database to get the package from <i><br>
name</i> of the package</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">the package entry on success,
NULL on error</p>

<p style="margin-left:11%; margin-top: 1em"><b>alpm_list_t
* alpm_db_get_pkgcache (alpm_db_t * db)</b> <br>
Get the package cache of a package database. This is a list
of all packages the db contains.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database to get the package from</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">the list of packages on
success, NULL on error</p>

<p style="margin-left:11%; margin-top: 1em"><b>alpm_list_t
* alpm_db_get_servers (const alpm_db_t * db)</b> <br>
Get the list of servers assigned to this db.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
database to get the servers from</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">a char* list of servers</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_db_get_siglevel (alpm_db_t * db)</b> <br>
Get the signature verification level for a database. Will
return the default verification level if this database is
set up with ALPM_SIG_USE_DEFAULT.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">the signature verification
level</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_db_get_usage (alpm_db_t * db, int * usage)</b> <br>
Gets the usage of a database.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database to get the status of <i><br>
usage</i> pointer to an alpm_db_usage_t to store db&rsquo;s
status</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">0 on success, or -1 on
error</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_db_get_valid (alpm_db_t * db)</b> <br>
Check the validity of a database. This is most useful for
sync databases and verifying signature status. If invalid,
the handle error code will be set accordingly.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">0 if valid, -1 if invalid
(pm_errno is set accordingly)</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_db_remove_server (alpm_db_t * db, const char * url)</b>
<br>
Remove a download server from a database.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> database pointer
<i><br>
url</i> url of the server</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">0 on success, 1 on server not
present, -1 on error (pm_errno is set accordingly)</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_db_search (alpm_db_t * db, const alpm_list_t * needles,
alpm_list_t ** ret)</b> <br>
Searches a database with regular expressions.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database to search in <i><br>
needles</i> a list of regular expressions to search for
<i><br>
ret</i> pointer to list for storing packages matching all
regular expressions - must point to an empty (NULL)
<b>alpm_list_t</b> *.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">0 on success, -1 on error
(pm_errno is set accordingly)</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_db_set_servers (alpm_db_t * db, alpm_list_t *
servers)</b> <br>
Sets the list of servers for the database to use.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> the database to set
the servers. The list will be duped and the original will
still need to be freed by the caller. <i><br>
servers</i> a char* list of servers.</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_db_set_usage (alpm_db_t * db, int usage)</b> <br>
Sets the usage of a database.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database to set the status for <i><br>
usage</i> a bitmask of alpm_db_usage_t values</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">0 on success, or -1 on
error</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_db_unregister (alpm_db_t * db)</b> <br>
Unregister a package database. Databases can not be
unregistered when there is an active transaction.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>db</i> pointer to the
package database to unregister</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">0 on success, -1 on error
(pm_errno is set accordingly)</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_db_update (alpm_handle_t * handle, alpm_list_t * dbs,
int force)</b> <br>
Update package databases. An update of the package databases
in the list <i>dbs</i> will be attempted. Unless
<i>force</i> is true, the update will only be performed if
the remote databases were modified since the last
update.</p>

<p style="margin-left:11%; margin-top: 1em">This operation
requires a database lock, and will return an applicable
error if the lock could not be obtained.</p>

<p style="margin-left:11%; margin-top: 1em">Example:</p>

<p style="margin-left:11%; margin-top: 1em">alpm_list_t
*dbs = alpm_get_syncdbs(config&minus;&gt;handle); <br>
ret = alpm_db_update(config&minus;&gt;handle, dbs, force);
<br>
if(ret &lt; 0) { <br>
pm_printf(ALPM_LOG_ERROR, _(&quot;failed to synchronize all
databases (%s)\n&quot;), <br>
alpm_strerror(alpm_errno(config&minus;&gt;handle))); <br>
}</p>


<p style="margin-left:11%; margin-top: 1em"><b>Note</b></p>

<p style="margin-left:17%;">After a successful update, the
<b>package cache</b> will be invalidated</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>handle</i> the context
handle <i><br>
dbs</i> list of package databases to update <i><br>
force</i> if true, then forces the update, otherwise update
only in case the databases aren&rsquo;t up to date</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">0 on success, -1 on error
(pm_errno is set accordingly), 1 if all databases are up to
to date</p>

<p style="margin-left:11%; margin-top: 1em"><b>alpm_db_t *
alpm_get_localdb (alpm_handle_t * handle)</b> <br>
Get the database of locally installed packages. The returned
pointer points to an internal structure of libalpm which
should only be manipulated through libalpm functions.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">a reference to the local
database</p>

<p style="margin-left:11%; margin-top: 1em"><b>alpm_list_t
* alpm_get_syncdbs (alpm_handle_t * handle)</b> <br>
Get the list of sync databases. Returns a list of alpm_db_t
structures, one for each registered sync database.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>handle</i> the context
handle</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">a reference to an internal list
of alpm_db_t structures</p>

<p style="margin-left:11%; margin-top: 1em"><b>alpm_db_t *
alpm_register_syncdb (alpm_handle_t * handle, const char *
treename, int level)</b> <br>
Register a sync database of packages. Databases can not be
registered when there is an active transaction.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>handle</i> the context
handle <i><br>
treename</i> the name of the sync repository <i><br>
level</i> what level of signature checking to perform on the
database; note that this must be a &rsquo;.sig&rsquo; file
type verification</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">an alpm_db_t* on success (the
value), NULL on error</p>

<p style="margin-left:11%; margin-top: 1em"><b>int
alpm_unregister_all_syncdbs (alpm_handle_t * handle)</b>
<br>
Unregister all package databases. Databases can not be
unregistered while there is an active transaction.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Parameters</b></p>

<p style="margin-left:17%;"><i>handle</i> the context
handle</p>


<p style="margin-left:11%; margin-top: 1em"><b>Returns</b></p>

<p style="margin-left:17%;">0 on success, -1 on error
(pm_errno is set accordingly)</p>

<h2>Author
<a name="Author"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Generated
automatically by Doxygen for libalpm from the source
code.</p>
<hr>
</body>
</html>
