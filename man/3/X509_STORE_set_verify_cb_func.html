<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:56:29 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>X509_STORE_SET_VERIFY_CB_FUNC</title>

</head>
<body>
<h1>X509_STORE_set_verify_cb_func</h1>



<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">X509_STORE_set_lookup_crls_cb,
X509_STORE_set_verify_func, X509_STORE_get_cleanup,
X509_STORE_set_cleanup, X509_STORE_get_lookup_crls,
X509_STORE_set_lookup_crls, X509_STORE_get_lookup_certs,
X509_STORE_set_lookup_certs, X509_STORE_get_check_policy,
X509_STORE_set_check_policy, X509_STORE_get_cert_crl,
X509_STORE_set_cert_crl, X509_STORE_get_check_crl,
X509_STORE_set_check_crl, X509_STORE_get_get_crl,
X509_STORE_set_get_crl, X509_STORE_get_check_revocation,
X509_STORE_set_check_revocation,
X509_STORE_get_check_issued, X509_STORE_set_check_issued,
X509_STORE_CTX_get1_issuer, X509_STORE_get_get_issuer,
X509_STORE_set_get_issuer, X509_STORE_CTX_get_verify,
X509_STORE_set_verify, X509_STORE_get_verify_cb,
X509_STORE_set_verify_cb_func, X509_STORE_set_verify_cb,
X509_STORE_CTX_cert_crl_fn, X509_STORE_CTX_check_crl_fn,
X509_STORE_CTX_check_issued_fn,
X509_STORE_CTX_check_policy_fn,
X509_STORE_CTX_check_revocation_fn,
X509_STORE_CTX_cleanup_fn, X509_STORE_CTX_get_crl_fn,
X509_STORE_CTX_get_issuer_fn,
X509_STORE_CTX_lookup_certs_fn,
X509_STORE_CTX_lookup_crls_fn &minus; set verification
callback</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">#include
&lt;openssl/x509_vfy.h&gt; <br>
typedef int (*X509_STORE_CTX_get_issuer_fn)(X509 **issuer,
<br>
X509_STORE_CTX *ctx, X509 *x); <br>
typedef int (*X509_STORE_CTX_check_issued_fn)(X509_STORE_CTX
*ctx, <br>
X509 *x, X509 *issuer); <br>
typedef int
(*X509_STORE_CTX_check_revocation_fn)(X509_STORE_CTX *ctx);
<br>
typedef int (*X509_STORE_CTX_get_crl_fn)(X509_STORE_CTX
*ctx, <br>
X509_CRL **crl, X509 *x); <br>
typedef int (*X509_STORE_CTX_check_crl_fn)(X509_STORE_CTX
*ctx, X509_CRL *crl); <br>
typedef int (*X509_STORE_CTX_cert_crl_fn)(X509_STORE_CTX
*ctx, <br>
X509_CRL *crl, X509 *x); <br>
typedef int (*X509_STORE_CTX_check_policy_fn)(X509_STORE_CTX
*ctx); <br>
typedef STACK_OF(X509)
*(*X509_STORE_CTX_lookup_certs_fn)(X509_STORE_CTX *ctx, <br>
const X509_NAME *nm); <br>
typedef STACK_OF(X509_CRL)
*(*X509_STORE_CTX_lookup_crls_fn)(const <br>
X509_STORE_CTX *ctx, <br>
const X509_NAME *nm); <br>
typedef int (*X509_STORE_CTX_cleanup_fn)(X509_STORE_CTX
*ctx); <br>
void X509_STORE_set_verify_cb(X509_STORE *ctx, <br>
X509_STORE_CTX_verify_cb verify_cb); <br>
X509_STORE_CTX_verify_cb X509_STORE_get_verify_cb(const
X509_STORE_CTX *ctx); <br>
void X509_STORE_set_verify(X509_STORE *ctx,
X509_STORE_CTX_verify_fn verify); <br>
X509_STORE_CTX_verify_fn X509_STORE_CTX_get_verify(const
X509_STORE_CTX *ctx); <br>
int X509_STORE_CTX_get1_issuer(X509 **issuer, X509_STORE_CTX
*ctx, X509 *x); <br>
X509_STORE_CTX_get_issuer_fn X509_STORE_get_get_issuer(const
X509_STORE_CTX *ctx); <br>
void X509_STORE_set_get_issuer(X509_STORE *ctx, <br>
X509_STORE_CTX_get_issuer_fn get_issuer); <br>
void X509_STORE_set_check_issued(X509_STORE *ctx, <br>
X509_STORE_CTX_check_issued_fn check_issued); <br>
X509_STORE_CTX_check_issued_fn <br>
X509_STORE_get_check_issued(const X509_STORE_CTX *ctx); <br>
void X509_STORE_set_check_revocation(X509_STORE *ctx, <br>
X509_STORE_CTX_check_revocation_fn check_revocation); <br>
X509_STORE_CTX_check_revocation_fn <br>
X509_STORE_get_check_revocation(const X509_STORE_CTX *ctx);
<br>
void X509_STORE_set_get_crl(X509_STORE *ctx, <br>
X509_STORE_CTX_get_crl_fn get_crl); <br>
X509_STORE_CTX_get_crl_fn X509_STORE_get_get_crl(const
X509_STORE_CTX *ctx); <br>
void X509_STORE_set_check_crl(X509_STORE *ctx, <br>
X509_STORE_CTX_check_crl_fn check_crl); <br>
X509_STORE_CTX_check_crl_fn <br>
X509_STORE_get_check_crl(const X509_STORE_CTX *ctx); <br>
void X509_STORE_set_cert_crl(X509_STORE *ctx, <br>
X509_STORE_CTX_cert_crl_fn cert_crl); <br>
X509_STORE_CTX_cert_crl_fn X509_STORE_get_cert_crl(const
X509_STORE_CTX *ctx); <br>
void X509_STORE_set_check_policy(X509_STORE *ctx, <br>
X509_STORE_CTX_check_policy_fn check_policy); <br>
X509_STORE_CTX_check_policy_fn <br>
X509_STORE_get_check_policy(const X509_STORE_CTX *ctx); <br>
void X509_STORE_set_lookup_certs(X509_STORE *ctx, <br>
X509_STORE_CTX_lookup_certs_fn lookup_certs); <br>
X509_STORE_CTX_lookup_certs_fn <br>
X509_STORE_get_lookup_certs(const X509_STORE_CTX *ctx); <br>
void X509_STORE_set_lookup_crls(X509_STORE *ctx, <br>
X509_STORE_CTX_lookup_crls_fn lookup_crls); <br>
X509_STORE_CTX_lookup_crls_fn <br>
X509_STORE_get_lookup_crls(const X509_STORE_CTX *ctx); <br>
void X509_STORE_set_cleanup(X509_STORE *ctx, <br>
X509_STORE_CTX_cleanup_fn cleanup); <br>
X509_STORE_CTX_cleanup_fn X509_STORE_get_cleanup(const
X509_STORE_CTX *ctx); <br>
/* Aliases */ <br>
void X509_STORE_set_verify_cb_func(X509_STORE *st, <br>
X509_STORE_CTX_verify_cb verify_cb); <br>
void X509_STORE_set_verify_func(X509_STORE *ctx, <br>
X509_STORE_CTX_verify_fn verify); <br>
void X509_STORE_set_lookup_crls_cb(X509_STORE *ctx, <br>
X509_STORE_CTX_lookup_crls_fn lookup_crls);</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_verify_cb()</b>
sets the verification callback of <i>ctx</i> to
<i>verify_cb</i> overwriting the previous callback. The
callback assigned with this function becomes a default for
the one that can be assigned directly to the corresponding
<b>X509_STORE_CTX</b>, please see
<b>X509_STORE_CTX_set_verify_cb</b>(3) for further
information.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_verify()</b>
sets the final chain verification function for <i>ctx</i> to
<i>verify</i>. Its purpose is to go through the chain of
certificates and check that all signatures are valid and
that the current time is within the limits of each
certificate&rsquo;s first and last validity time. The final
chain verification functions must return 0 on failure and 1
on success. <i>If no chain verification function is
provided, the internal default function will be used
instead.</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_CTX_get1_issuer()</b>
tries to find a certificate from the <i>store</i> component
of <i>ctx</i> with a subject name matching the issuer name
of <i>x</i>. On success it assigns to <i>*issuer</i> the
first match that is currently valid, or at least the most
recently expired match if there is no currently valid one.
If the function returns 1 the caller is responsible for
freeing <i>*issuer</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_get_issuer()</b>
sets the function <i>get_issuer</i> to get the
&quot;best&quot; candidate issuer certificate of the given
certificate <i>x</i>. When such a certificate is found,
<i>get_issuer</i> must up-ref and assign it to
<i>*issuer</i> and then return 1. Otherwise
<i>get_issuer</i> must return 0 if not found and &minus;1
(or 0) on failure. If <b>X509_STORE_set_get_issuer()</b> is
not used or <i>get_issuer</i> is <small>NULL</small> then
<b>X509_STORE_CTX_get1_issuer()</b> is used as the default
implementation.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_check_issued()</b>
sets the function to check that a given certificate <i>x</i>
is issued by the issuer certificate <i>issuer</i>. This
function must return 0 on failure (among others if <i>x</i>
hasn&rsquo;t been issued with <i>issuer</i>) and 1 on
success. <i>If no function to get the issuer is provided,
the internal default function will be used instead.</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_check_revocation()</b>
sets the revocation checking function. Its purpose is to
look through the final chain and check the revocation status
for each certificate. It must return 0 on failure and 1 on
success. <i>If no function to get the issuer is provided,
the internal default function will be used instead.</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_get_crl()</b>
sets the function to get the crl for a given certificate
<i>x</i>. When found, the crl must be assigned to
<i>*crl</i>. This function must return 0 on failure and 1 on
success. <i>If no function to get the issuer is provided,
the internal default function will be used instead.</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_check_crl()</b>
sets the function to check the validity of the given
<i>crl</i>. This function must return 0 on failure and 1 on
success. <i>If no function to get the issuer is provided,
the internal default function will be used instead.</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_cert_crl()</b>
sets the function to check the revocation status of the
given certificate <i>x</i> against the given <i>crl</i>.
This function must return 0 on failure and 1 on success.
<i>If no function to get the issuer is provided, the
internal default function will be used instead.</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_check_policy()</b>
sets the function to check the policies of all the
certificates in the final chain.. This function must return
0 on failure and 1 on success. <i>If no function to get the
issuer is provided, the internal default function will be
used instead.</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_lookup_certs()</b>
and <b>X509_STORE_set_lookup_crls()</b> set the functions to
look up all the certs or all the CRLs that match the given
name <i>nm</i>. These functions return <small>NULL</small>
on failure and a pointer to a stack of certificates
(<b>X509</b>) or to a stack of CRLs (<b>X509_CRL</b>) on
success. <i>If no function to get the issuer is provided,
the internal default function will be used instead.</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_cleanup()</b>
sets the final cleanup function, which is called when the
context (<b>X509_STORE_CTX</b>) is being torn down. This
function doesn&rsquo;t return any value. <i>If no function
to get the issuer is provided, the internal default function
will be used instead.</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_get_verify_cb()</b>,
<b>X509_STORE_CTX_get_verify()</b>,
<b>X509_STORE_get_get_issuer()</b>,
<b>X509_STORE_get_check_issued()</b>,
<b>X509_STORE_get_check_revocation()</b>,
<b>X509_STORE_get_get_crl()</b>,
<b>X509_STORE_get_check_crl()</b>,
<b>X509_STORE_set_verify()</b>,
<b>X509_STORE_set_get_issuer()</b>,
<b>X509_STORE_get_cert_crl()</b>,
<b>X509_STORE_get_check_policy()</b>,
<b>X509_STORE_get_lookup_certs()</b>,
<b>X509_STORE_get_lookup_crls()</b> and
<b>X509_STORE_get_cleanup()</b> all return the function
pointer assigned with <b>X509_STORE_set_check_issued()</b>,
<b>X509_STORE_set_check_revocation()</b>,
<b>X509_STORE_set_get_crl()</b>,
<b>X509_STORE_set_check_crl()</b>,
<b>X509_STORE_set_cert_crl()</b>,
<b>X509_STORE_set_check_policy()</b>,
<b>X509_STORE_set_lookup_certs()</b>,
<b>X509_STORE_set_lookup_crls()</b> and
<b>X509_STORE_set_cleanup()</b>, or <small>NULL</small> if
no assignment has been made.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_set_verify_cb_func()</b>,
<b>X509_STORE_set_verify_func()</b> and
<b>X509_STORE_set_lookup_crls_cb()</b> are aliases for
<b>X509_STORE_set_verify_cb()</b>,
<b>X509_STORE_set_verify()</b> and
X509_STORE_set_lookup_crls, available as macros for backward
compatibility.</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">All the
callbacks from a <b>X509_STORE</b> are inherited by the
corresponding <b>X509_STORE_CTX</b> structure when it is
initialized. See <b>X509_STORE_CTX_set_verify_cb</b>(3) for
further details.</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The macro
version of this function was the only one available before
OpenSSL 1.0.0.</p>

<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
X509_STORE_set_*() functions do not return a value.</p>

<p style="margin-left:11%; margin-top: 1em">The
X509_STORE_get_*() functions return a pointer of the
appropriate function type.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_CTX_get1_issuer()</b>
returns 1 if a suitable certificate is found, 0 if not
found, &minus;1 on other error.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>X509_STORE_CTX_set_verify_cb</b>(3),
<b>X509_STORE_CTX_get0_chain</b>(3),
<b>X509_STORE_CTX_verify_cb</b>(3),
<b>X509_STORE_CTX_verify_fn</b>(3), <b>CMS_verify</b>(3)</p>

<h2>HISTORY
<a name="HISTORY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>X509_STORE_set_verify_cb()</b> function was added in
OpenSSL 1.0.0.</p>

<p style="margin-left:11%; margin-top: 1em">The functions
<b>X509_STORE_set_verify_cb()</b>,
<b>X509_STORE_get_verify_cb()</b>,
<b>X509_STORE_set_verify()</b>,
<b>X509_STORE_CTX_get_verify()</b>,
<b>X509_STORE_set_get_issuer()</b>,
<b>X509_STORE_get_get_issuer()</b>,
<b>X509_STORE_set_check_issued()</b>,
<b>X509_STORE_get_check_issued()</b>,
<b>X509_STORE_set_check_revocation()</b>,
<b>X509_STORE_get_check_revocation()</b>,
<b>X509_STORE_set_get_crl()</b>,
<b>X509_STORE_get_get_crl()</b>,
<b>X509_STORE_set_check_crl()</b>,
<b>X509_STORE_get_check_crl()</b>,
<b>X509_STORE_set_cert_crl()</b>,
<b>X509_STORE_get_cert_crl()</b>,
<b>X509_STORE_set_check_policy()</b>,
<b>X509_STORE_get_check_policy()</b>,
<b>X509_STORE_set_lookup_certs()</b>,
<b>X509_STORE_get_lookup_certs()</b>,
<b>X509_STORE_set_lookup_crls()</b>,
<b>X509_STORE_get_lookup_crls()</b>,
<b>X509_STORE_set_cleanup()</b> and
<b>X509_STORE_get_cleanup()</b> were added in OpenSSL
1.1.0.</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Copyright
2009&minus;2021 The OpenSSL Project Authors. All Rights
Reserved.</p>

<p style="margin-left:11%; margin-top: 1em">Licensed under
the Apache License 2.0 (the &quot;License&quot;). You may
not use this file except in compliance with the License. You
can obtain a copy in the file <small>LICENSE</small> in the
source distribution or at
&lt;https://www.openssl.org/source/license.html&gt;.</p>
<hr>
</body>
</html>
