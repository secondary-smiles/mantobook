<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:56:58 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>DEPENDENCY</title>

</head>
<body>
<h1>dependency-selectors</h1>



<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Dependency</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>Description</b>
<br>
The npm help <b>query</b> commmand exposes a new dependency
selector syntax (informed by &amp; respecting many aspects
of the CSS Selectors 4 Spec
<i>https://dev.w3.org/csswg/selectors4/#relational)</i>
which:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p>Standardizes the shape of, &amp; querying of, dependency
graphs with a robust object model, metadata &amp; selector
syntax</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p>Leverages existing, known language syntax &amp;
operators from CSS to make disparate package information
broadly accessible</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p>Unlocks the ability to answer complex,
multi&minus;faceted questions about dependencies, their
relationships &amp; associative metadata</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p>Consolidates redundant logic of similar query commands
in <b>npm</b> (ex. <b>npm fund</b>, <b>npm ls</b>, <b>npm
outdated</b>, <b>npm audit</b> ...)</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>Dependency
Selector Syntax v1.0.0 <br>
Overview:</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p style="margin-top: 1em">there is no &quot;type&quot; or
&quot;tag&quot; selectors (ex. <b>div, h1, a</b>) as a
dependency/target is the only type of <b>Node</b> that can
be queried</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p>the term &quot;dependencies&quot; is in reference to any
<b>Node</b> found in a <b>tree</b> returned by
<b>Arborist</b></p> </td></tr>
</table>


<p style="margin-left:11%; margin-top: 1em"><b>Combinators</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="38%">


<p style="margin-top: 1em"><b>&gt;</b> direct
descendant/child</p> </td>
<td width="48%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="38%">


<p>any descendant/child</p></td>
<td width="48%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="38%">


<p><b>~</b> sibling</p></td>
<td width="48%">
</td></tr>
</table>


<p style="margin-left:11%; margin-top: 1em"><b>Selectors</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p style="margin-top: 1em"><b>*</b> universal selector</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>#&lt;name&gt;</b> dependency selector (equivalent to
<b>[name=&quot;...&quot;]</b>)</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>#&lt;name&gt;@&lt;version&gt;</b> (equivalent to
<b>[name=&lt;name&gt;]:semver(&lt;version&gt;)</b>)</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>,</b> selector list delimiter</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>.</b> dependency type selector</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:</b> pseudo selector</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>Dependency
Type Selectors</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p style="margin-top: 1em"><b>.prod</b> dependency found in
the <b>dependencies</b> section of <b>package.json</b>, or
is a child of said dependency</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>.dev</b> dependency found in the
<b>devDependencies</b> section of <b>package.json</b>, or is
a child of said dependency</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>.optional</b> dependency found in the
<b>optionalDependencies</b> section of <b>package.json</b>,
or has <b>&quot;optional&quot;: true</b> set in its entry in
the <b>peerDependenciesMeta</b> section of
<b>package.json</b>, or a child of said dependency</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>.peer</b> dependency found in the
<b>peerDependencies</b> section of <b>package.json</b></p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>.workspace</b> dependency found in the
<b>workspaces</b>
<i>https://docs.npmjs.com/cli/v8/using&minus;npm/workspaces</i>
section of <b>package.json</b></p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>.bundled</b> dependency found in the
<b>bundleDependencies</b> section of <b>package.json</b>, or
is a child of said dependency</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>Pseudo
Selectors</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p style="margin-top: 1em"><b>:not(&lt;selector&gt;)</b>
<i>https://developer.mozilla.org/en&minus;US/docs/Web/CSS/:not</i></p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:has(&lt;selector&gt;)</b>
<i>https://developer.mozilla.org/en&minus;US/docs/Web/CSS/:has</i></p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:is(&lt;selector list&gt;)</b>
<i>https://developer.mozilla.org/en&minus;US/docs/Web/CSS/:is</i></p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:root</b>
<i>https://developer.mozilla.org/en&minus;US/docs/Web/CSS/:root</i>
matches the root node/dependency</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:scope</b>
<i>https://developer.mozilla.org/en&minus;US/docs/Web/CSS/:scope</i>
matches node/dependency it was queried against</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:empty</b>
<i>https://developer.mozilla.org/en&minus;US/docs/Web/CSS/:empty</i>
when a dependency has no dependencies</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:private</b>
<i>https://docs.npmjs.com/cli/v8/configuring&minus;npm/package&minus;json#private</i>
when a dependency is private</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:link</b> when a dependency is linked (for instance,
workspaces or packages manually <b>linked</b>
<i>https://docs.npmjs.com/cli/v8/commands/npm&minus;link</i></p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:deduped</b> when a dependency has been deduped (note
that this does <i>not</i> always mean the dependency has
been hoisted to the root of node_modules)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:overridden</b> when a dependency has been
overridden</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:extraneous</b> when a dependency exists but is not
defined as a dependency of any node</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:invalid</b> when a dependency version is out of its
ancestors specified range</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:missing</b> when a dependency is not found on
disk</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:semver(&lt;spec&gt;)</b> matching a valid
<b>node&minus;semver</b>
<i>https://github.com/npm/node&minus;semver</i> spec</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:path(&lt;path&gt;)</b> glob
<i>https://www.npmjs.com/package/glob</i> matching based on
dependencies path relative to the project</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>:type(&lt;type&gt;)</b> based on currently recognized
types
<i>https://github.com/npm/npm&minus;package&minus;arg#result&minus;object</i></p> </td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>Attribute
Selectors</b>
<i>https://developer.mozilla.org/en&minus;US/docs/Web/CSS/Attribute_selectors</i>
<br>
The attribute selector evaluates the key/value pairs in
<b>package.json</b> if they are <b>String</b>s.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p style="margin-top: 1em"><b>[]</b> attribute selector
(ie. existence of attribute)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>[attribute=value]</b> attribute value is
equivalant...</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>[attribute~=value]</b> attribute value contains
word...</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>[attribute*=value]</b> attribute value contains
string...</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>[attribute|=value]</b> attribute value is equal to or
starts with...</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>[attribute^=value]</b> attribute value starts
with...</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p><b>[attribute$=value]</b> attribute value ends
with...</p> </td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>Array &amp;
Object Attribute Selectors</b> <br>
The generic <b>:attr()</b> pseudo selector standardizes a
pattern which can be used for attribute selection of
<b>Object</b>s, <b>Array</b>s or <b>Arrays</b> of
<b>Object</b>s accessible via <b>Arborist</b>&rsquo;s
<b>Node.package</b> metadata. This allows for iterative
attribute selection beyond top&minus;level <b>String</b>
evaluation. The last argument passed to <b>:attr()</b> must
be an <b>attribute</b> selector or a nested <b>:attr()</b>.
See examples below:</p>


<p style="margin-left:11%; margin-top: 1em"><b>Objects</b></p>

<p style="margin-left:14%;">/* return dependencies that
have a &lsquo;scripts.test&lsquo; containing
&lsquo;&quot;tap&quot;&lsquo; */ <br>
*:attr(scripts, [test~=tap])</p>

<p style="margin-left:11%; margin-top: 1em"><b>Nested
Objects</b> <br>
Nested objects are expressed as sequential arguments to
<b>:attr()</b>.</p>

<p style="margin-left:14%; margin-top: 1em">/* return
dependencies that have a testling config for opera browsers
*/ <br>
*:attr(testling, browsers, [~=opera])</p>

<p style="margin-left:11%; margin-top: 1em"><b>Arrays <br>
Array</b>s specifically uses a special/reserved <b>.</b>
character in place of a typical attribute name.
<b>Arrays</b> also support exact <b>value</b> matching when
a <b>String</b> is passed to the selector.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example of
an Array Attribute Selection:</b></p>

<p style="margin-left:14%;">/* removes the distinction
between properties &amp; arrays */ <br>
/* ie. we&rsquo;d have to check the property &amp; iterate
to match selection */ <br>
*:attr([keywords^=react]) <br>
*:attr(contributors, :attr([name~=Jordan]))</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example of
an Array matching directly to a value:</b></p>

<p style="margin-left:14%;">/* return dependencies that
have the exact keyword &quot;react&quot; */ <br>
/* this is equivalent to
&lsquo;*:keywords([value=&quot;react&quot;])&lsquo; */ <br>
*:attr([keywords=react])</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example of
an Array of Objects:</b></p>

<p style="margin-left:14%;">/* returns */ <br>
*:attr(contributors, [email=ruyadorno@github.com])</p>

<p style="margin-left:11%; margin-top: 1em"><b>Groups</b>
<br>
Dependency groups are defined by the package relationships
to their ancestors (ie. the dependency types that are
defined in <b>package.json</b>). This approach is
user&minus;centric as the ecosystem has been taught to think
about dependencies in these groups
first&minus;and&minus;foremost. Dependencies are allowed to
be included in multiple groups (ex. a <b>prod</b> dependency
may also be a <b>dev</b> dependency (in that it&rsquo;s also
required by another <b>dev</b> dependency) &amp; may also be
<b>bundled</b> &minus; a selector for that type of
dependency would look like: <b>*.prod.dev.bundled</b>).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="15%">


<p style="margin-top: 1em"><b>.prod</b></p></td>
<td width="71%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="15%">


<p><b>.dev</b></p></td>
<td width="71%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="15%">


<p><b>.optional</b></p></td>
<td width="71%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="15%">


<p><b>.peer</b></p></td>
<td width="71%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="15%">


<p><b>.bundled</b></p></td>
<td width="71%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="15%">


<p><b>.workspace</b></p></td>
<td width="71%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Please note
that currently <b>workspace</b> deps are always <b>prod</b>
dependencies. Additionally the <b>.root</b> dependency is
also considered a <b>prod</b> dependency.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Programmatic
Usage</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="83%">


<p style="margin-top: 1em"><b>Arborist</b>&rsquo;s
<b>Node</b> Class has a <b>.querySelectorAll()</b>
method</p> </td>
<td width="3%">
</td></tr>
</table>

<p style="margin-left:14%;">&bull;</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="17%"></td>
<td width="83%">


<p style="margin-top: 1em">this method will return a
filtered, flattened dependency Arborist <b>Node</b> list
based on a valid query selector</p></td></tr>
</table>

<p style="margin-left:14%; margin-top: 1em">const Arborist
= require(&rsquo;@npmcli/arborist&rsquo;) <br>
const arb = new Arborist({})</p>

<p style="margin-left:14%; margin-top: 1em">//
root&minus;level <br>
arb.loadActual().then(async (tree) =&gt; { <br>
// query all production dependencies <br>
const results = await
tree.querySelectorAll(&rsquo;.prod&rsquo;) <br>
console.log(results) <br>
})</p>

<p style="margin-left:14%; margin-top: 1em">// iterative
<br>
arb.loadActual().then(async (tree) =&gt; { <br>
// query for the deduped version of react <br>
const results = await
tree.querySelectorAll(&rsquo;#react:not(:deduped)&rsquo;)
<br>
// query the deduped react for git deps <br>
const deps = await
results[0].querySelectorAll(&rsquo;:type(git)&rsquo;) <br>
console.log(deps) <br>
})</p>

<h2>See Also
<a name="See Also"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="74%">


<p style="margin-top: 1em">npm help query</p></td>
<td width="12%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="74%">


<p>@npmcli/arborist
<i>https://npm.im/@npmcli/arborist</i></p> </td>
<td width="12%">
</td></tr>
 </table>
<hr>
</body>
</html>
