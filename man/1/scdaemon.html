<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:54:01 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SCDAEMON</title>

</head>
<body>
<h1>scdaemon</h1>



<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>scdaemon</b>
&minus; Smartcard daemon for the GnuPG system</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>scdaemon</b>
[<b>&minus;&minus;homedir</b> <i>dir</i>]
[<b>&minus;&minus;options</b> <i>file</i>] [<i>options</i>]
<b>&minus;&minus;server <br>
scdaemon</b> [<b>&minus;&minus;homedir</b> <i>dir</i>]
[<b>&minus;&minus;options</b> <i>file</i>] [<i>options</i>]
<b>&minus;&minus;daemon</b> [<i>command_line</i>]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>scdaemon</b> is a daemon to manage smartcards. It is
usually invoked by <b>gpg-agent</b> and in general not used
directly.</p>

<h2>COMMANDS
<a name="COMMANDS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Commands are
not distinguished from options except for the fact that only
one command is allowed. <b><br>
--version</b></p>

<p style="margin-left:22%;">Print the program version and
licensing information. Note that you cannot abbreviate this
command.</p>

<p style="margin-left:11%;"><b>--help, -h</b></p>

<p style="margin-left:22%;">Print a usage message
summarizing the most useful command-line options. Note that
you cannot abbreviate this command.</p>

<p style="margin-left:11%;"><b>--dump-options</b></p>

<p style="margin-left:22%;">Print a list of all available
options and commands. Note that you cannot abbreviate this
command.</p>

<p style="margin-left:11%;"><b>--server</b></p>

<p style="margin-left:22%;">Run in server mode and wait for
commands on the <b>stdin</b>. The default mode is to create
a socket and listen for commands there.</p>

<p style="margin-left:11%;"><b>--multi-server</b></p>

<p style="margin-left:22%;">Run in server mode and wait for
commands on the <b>stdin</b> as well as on an additional
Unix Domain socket. The server command <b>GETINFO</b> may be
used to get the name of that extra socket.</p>

<p style="margin-left:11%;"><b>--daemon</b></p>

<p style="margin-left:22%;">Run the program in the
background. This option is required to prevent it from being
accidentally running in the background.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>--options</b>
<i>file</i></p>

<p style="margin-left:22%;">Reads configuration from
<i>file</i> instead of from the default per-user
configuration file. The default configuration file is named
&lsquo;<i>scdaemon.conf</i>&rsquo; and expected in the
&lsquo;<i>.gnupg</i>&rsquo; directory directly below the
home directory of the user.</p>

<p style="margin-left:11%;"><b>--homedir</b> <i>dir</i></p>

<p style="margin-left:22%;">Set the name of the home
directory to <i>dir</i>. If this option is not used, the
home directory defaults to &lsquo;<i>~/.gnupg</i>&rsquo;. It
is only recognized when given on the command line. It also
overrides any home directory stated through the environment
variable &lsquo;<i>GNUPGHOME</i>&rsquo; or (on Windows
systems) by means of the Registry entry
<i>HKCU\Software\GNU\GnuPG:HomeDir</i>.</p>

<p style="margin-left:22%; margin-top: 1em">On Windows
systems it is possible to install GnuPG as a portable
application. In this case only this command line option is
considered, all other ways to set a home directory are
ignored.</p>

<p style="margin-left:22%; margin-top: 1em">To install
GnuPG as a portable application under Windows, create an
empty file named &lsquo;<i>gpgconf.ctl</i>&rsquo; in the
same directory as the tool &lsquo;<i>gpgconf.exe</i>&rsquo;.
The root of the installation is then that directory; or, if
&lsquo;<i>gpgconf.exe</i>&rsquo; has been installed directly
below a directory named &lsquo;<i>bin</i>&rsquo;, its parent
directory. You also need to make sure that the following
directories exist and are writable:
&lsquo;<i>ROOT/home</i>&rsquo; for the GnuPG home and
&lsquo;<i>ROOT/usr/var/cache/gnupg</i>&rsquo; for internal
cache files.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-v</b></p></td>
<td width="86%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>--verbose</b></p>

<p style="margin-left:22%;">Outputs additional information
while running. You can increase the verbosity by giving
several verbose commands to <b>gpgsm</b>, such as
&lsquo;-vv&rsquo;.</p>

<p style="margin-left:11%;"><b>--debug-level</b>
<i>level</i></p>

<p style="margin-left:22%;">Select the debug level for
investigating problems. <i>level</i> may be a numeric value
or a keyword:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="22%"></td>
<td width="7%">


<p><b>none</b></p></td>
<td width="3%"></td>
<td width="68%">


<p>No debugging at all. A value of less than 1 may be used
instead of the keyword.</p></td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="7%">


<p><b>basic</b></p></td>
<td width="3%"></td>
<td width="68%">


<p>Some basic debug messages. A value between 1 and 2 may
be used instead of the keyword.</p></td></tr>
</table>

<p style="margin-left:22%;"><b>advanced</b></p>

<p style="margin-left:32%;">More verbose debug messages. A
value between 3 and 5 may be used instead of the
keyword.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="22%"></td>
<td width="9%">


<p><b>expert</b></p></td>
<td width="1%"></td>
<td width="68%">


<p>Even more detailed messages. A value between 6 and 8 may
be used instead of the keyword.</p></td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="9%">


<p><b>guru</b></p></td>
<td width="1%"></td>
<td width="68%">


<p>All of the debug messages you can get. A value greater
than 8 may be used instead of the keyword. The creation of
hash tracing files is only enabled if the keyword is
used.</p> </td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">How these
messages are mapped to the actual debugging flags is not
specified and may change with newer releases of this
program. They are however carefully selected to best aid in
debugging.</p>

<p style="margin-left:22%; margin-top: 1em"><b>All
debugging options are subject to change and thus should not
be used by any application program. As the name says, they
are only used as helpers to debug problems.</b></p>

<p style="margin-left:11%;"><b>--debug</b> <i>flags</i></p>

<p style="margin-left:22%;">This option is only useful for
debugging and the behavior may change at any time without
notice. FLAGS are bit encoded and may be given in usual
C-Syntax. The currently defined bits are:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="22%"></td>
<td width="9%">


<p><b>0 (1)</b></p></td>
<td width="1%"></td>
<td width="45%">


<p>command I/O</p></td>
<td width="23%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="9%">


<p><b>1 (2)</b></p></td>
<td width="1%"></td>
<td width="45%">


<p>values of big number integers</p></td>
<td width="23%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="9%">


<p><b>2 (4)</b></p></td>
<td width="1%"></td>
<td width="45%">


<p>low level crypto operations</p></td>
<td width="23%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="9%">


<p><b>5 (32)</b></p></td>
<td width="1%"></td>
<td width="45%">


<p>memory allocation</p></td>
<td width="23%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="9%">


<p><b>6 (64)</b></p></td>
<td width="1%"></td>
<td width="45%">


<p>caching</p></td>
<td width="23%">
</td></tr>
</table>

<p style="margin-left:22%;"><b>7 (128)</b></p>

<p style="margin-left:32%;">show memory statistics</p>

<p style="margin-left:22%;"><b>9 (512)</b></p>

<p style="margin-left:32%;">write hashed data to files
named <b>dbgmd-000*</b></p>

<p style="margin-left:22%;"><b>10 (1024)</b></p>

<p style="margin-left:32%;">trace Assuan protocol. See also
option <b>--debug-assuan-log-cats</b>.</p>

<p style="margin-left:22%;"><b>11 (2048)</b></p>

<p style="margin-left:32%;">trace APDU I/O to the card.
This may reveal sensitive data.</p>

<p style="margin-left:22%;"><b>12 (4096)</b></p>

<p style="margin-left:32%;">trace some card reader related
function calls.</p>

<p style="margin-left:11%;"><b>--debug-all</b></p>

<p style="margin-left:22%;">Same as
<b>--debug=0xffffffff</b></p>

<p style="margin-left:11%;"><b>--debug-wait</b>
<i>n</i></p>

<p style="margin-left:22%;">When running in server mode,
wait <i>n</i> seconds before entering the actual processing
loop and print the pid. This gives time to attach a
debugger.</p>

<p style="margin-left:11%;"><b>--debug-ccid-driver</b></p>

<p style="margin-left:22%;">Enable debug output from the
included CCID driver for smartcards. Using this option twice
will also enable some tracing of the T=1 protocol. Note that
this option may reveal sensitive data.</p>


<p style="margin-left:11%;"><b>--debug-disable-ticker</b></p>

<p style="margin-left:22%;">This option disables all ticker
functions like checking for card insertions.</p>


<p style="margin-left:11%;"><b>--debug-allow-core-dump</b></p>

<p style="margin-left:22%;">For security reasons we
won&rsquo;t create a core dump when the process aborts. For
debugging purposes it is sometimes better to allow core
dump. This option enables it and also changes the working
directory to &lsquo;<i>/tmp</i>&rsquo; when running in
<b>--server</b> mode.</p>

<p style="margin-left:11%;"><b>--debug-log-tid</b></p>

<p style="margin-left:22%;">This option appends a thread ID
to the PID in the log output.</p>

<p style="margin-left:11%;"><b>--debug-assuan-log-cats</b>
<i>cats</i></p>

<p style="margin-left:22%;">Changes the active Libassuan
logging categories to <i>cats</i>. The value for <i>cats</i>
is an unsigned integer given in usual C-Syntax. A value of 0
switches to a default category. If this option is not used
the categories are taken from the environment variable
<b>ASSUAN_DEBUG</b>. Note that this option has only an
effect if the Assuan debug flag has also been with the
option <b>--debug</b>. For a list of categories see the
Libassuan manual.</p>

<p style="margin-left:11%;"><b>--no-detach</b></p>

<p style="margin-left:22%;">Don&rsquo;t detach the process
from the console. This is mainly useful for debugging.</p>

<p style="margin-left:11%;"><b>--listen-backlog</b>
<i>n</i></p>

<p style="margin-left:22%;">Set the size of the queue for
pending connections. The default is 64. This option has an
effect only if <b>--multi-server</b> is also used.</p>

<p style="margin-left:11%;"><b>--log-file</b>
<i>file</i></p>

<p style="margin-left:22%;">Append all logging output to
<i>file</i>. This is very helpful in seeing what the agent
actually does. Use &lsquo;<i>socket://</i>&rsquo; to log to
socket.</p>

<p style="margin-left:11%;"><b>--pcsc-shared</b></p>

<p style="margin-left:22%;">Use shared mode to access the
card via PC/SC. This is a somewhat dangerous option because
Scdaemon assumes exclusivbe access to teh card and for
example caches certain information from the card. Use this
option only if you know what you are doing.</p>

<p style="margin-left:11%;"><b>--pcsc-driver</b>
<i>library</i></p>

<p style="margin-left:22%;">Use <i>library</i> to access
the smartcard reader. The current default on Unix is
&lsquo;<i>libpcsclite.so</i>&rsquo; and on Windows
&lsquo;<i>winscard.dll</i>&rsquo;. Instead of using this
option you might also want to install a symbolic link to the
default file name (e.g. from
&lsquo;<i>libpcsclite.so.1</i>&rsquo;). A Unicode file name
may not be used on Windows.</p>

<p style="margin-left:11%;"><b>--ctapi-driver</b>
<i>library</i></p>

<p style="margin-left:22%;">Use <i>library</i> to access
the smartcard reader. The current default is
&lsquo;<i>libtowitoko.so</i>&rsquo;. Note that the use of
this interface is deprecated; it may be removed in future
releases.</p>

<p style="margin-left:11%;"><b>--disable-ccid</b></p>

<p style="margin-left:22%;">Disable the integrated support
for CCID compliant readers. This allows falling back to one
of the other drivers even if the internal CCID driver can
handle the reader. Note, that CCID support is only available
if libusb was available at build time.</p>

<p style="margin-left:11%;"><b>--reader-port</b>
<i>number_or_string</i></p>

<p style="margin-left:22%;">This option may be used to
specify the port of the card terminal. A value of 0 refers
to the first serial device; add 32768 to access USB devices.
The default is 32768 (first USB device). PC/SC or CCID
readers might need a string here; run the program in verbose
mode to get a list of available readers. The default is then
the first reader found.</p>

<p style="margin-left:22%; margin-top: 1em">To get a list
of available CCID readers you may use this command:</p>

<p style="margin-left:14%;">echo scd getinfo reader_list \
<br>
| gpg-connect-agent --decode | awk &rsquo;/^D/ {print
$2}&rsquo;</p>

<p style="margin-left:11%;"><b>--card-timeout</b>
<i>n</i></p>

<p style="margin-left:22%;">If <i>n</i> is not 0 and no
client is actively using the card, the card will be powered
down after <i>n</i> seconds. Powering down the card avoids a
potential risk of damaging a card when used with certain
cheap readers. This also allows applications that are not
aware of Scdaemon to access the card. The disadvantage of
using a card timeout is that accessing the card takes longer
and that the user needs to enter the PIN again after the
next power up.</p>

<p style="margin-left:22%; margin-top: 1em">Note that with
the current version of Scdaemon the card is powered down
immediately at the next timer tick for any value of <i>n</i>
other than 0.</p>


<p style="margin-left:11%;"><b>--enable-pinpad-varlen</b></p>

<p style="margin-left:22%;">Please specify this option when
the card reader supports variable length input for pinpad
(default is no). For known readers (listed in ccid-driver.c
and apdu.c), this option is not needed. Note that if your
card reader doesn&rsquo;t supports variable length input but
you want to use it, you need to specify your pinpad request
on your card.</p>

<p style="margin-left:11%;"><b>--disable-pinpad</b></p>

<p style="margin-left:22%;">Even if a card reader features
a pinpad, do not try to use it.</p>

<p style="margin-left:11%;"><b>--deny-admin</b></p>

<p style="margin-left:22%;">This option disables the use of
admin class commands for card applications where this is
supported. Currently we support it for the OpenPGP card.
This option is useful to inhibit accidental access to admin
class command which could ultimately lock the card through
wrong PIN numbers. Note that GnuPG versions older than
2.0.11 featured an <b>--allow-admin</b> option which was
required to use such admin commands. This option has no more
effect today because the default is now to allow admin
commands.</p>

<p style="margin-left:11%;"><b>--disable-application</b>
<i>name</i></p>

<p style="margin-left:22%;">This option disables the use of
the card application named <i>name</i>. This is mainly
useful for debugging or if a application with lower priority
should be used by default.</p>

<p style="margin-left:11%; margin-top: 1em">All the long
options may also be given in the configuration file after
stripping off the two leading dashes.</p>

<h2>CARD APPLICATIONS
<a name="CARD APPLICATIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>scdaemon</b>
supports the card applications as described below.</p>

<p style="margin-left:11%; margin-top: 1em"><b>The OpenPGP
card application &lsquo;&lsquo;openpgp&rsquo;&rsquo;
&nbsp;</b></p>

<p style="margin-left:11%; margin-top: 1em">This
application is currently only used by <b>gpg</b> but may in
future also be useful with <b>gpgsm</b>. Version 1 and
version 2 of the card is supported.</p>

<p style="margin-left:11%; margin-top: 1em">The
specifications for these cards are available at <br>
(<b>http://g10code.com/docs/openpgp-card-1.0.pdf</b>) and
<br>
(<b>http://g10code.com/docs/openpgp-card-2.0.pdf</b>).</p>

<p style="margin-left:11%; margin-top: 1em"><b>The Telesec
NetKey card &lsquo;&lsquo;nks&rsquo;&rsquo; &nbsp;</b></p>

<p style="margin-left:11%; margin-top: 1em">This is the
main application of the Telesec cards as available in
Germany. It is a superset of the German DINSIG card. The
card is used by <b>gpgsm</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>The DINSIG
card application &lsquo;&lsquo;dinsig&rsquo;&rsquo;
&nbsp;</b></p>

<p style="margin-left:11%; margin-top: 1em">This is an
application as described in the German draft standard <i>DIN
V 66291-1</i>. It is intended to be used by cards supporting
the German signature law and its bylaws (SigG and SigV).</p>

<p style="margin-left:11%; margin-top: 1em"><b>The PKCS#15
card application &lsquo;&lsquo;p15&rsquo;&rsquo;
&nbsp;</b></p>

<p style="margin-left:11%; margin-top: 1em">This is common
framework for smart card applications. It is used by
<b>gpgsm</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>The
Geldkarte card application
&lsquo;&lsquo;geldkarte&rsquo;&rsquo; &nbsp;</b></p>

<p style="margin-left:11%; margin-top: 1em">This is a
simple application to display information of a German
Geldkarte. The Geldkarte is a small amount debit card
application which comes with almost all German banking
cards.</p>

<p style="margin-left:11%; margin-top: 1em"><b>The
SmartCard-HSM card application
&lsquo;&lsquo;sc-hsm&rsquo;&rsquo; &nbsp;</b></p>

<p style="margin-left:11%; margin-top: 1em">This
application adds read-only support for keys and certificates
stored on a (<b>http://www.smartcard-hsm.com,
SmartCard-HSM</b>).</p>

<p style="margin-left:11%; margin-top: 1em">To generate
keys and store certificates you may use
(<b>https://github.com/OpenSC/OpenSC/wiki/SmartCardHSM,
OpenSC</b>) or the tools from (<b>http://www.openscdp.org,
OpenSCDP</b>).</p>

<p style="margin-left:11%; margin-top: 1em">The
SmartCard-HSM cards requires a card reader that supports
Extended Length APDUs.</p>

<p style="margin-left:11%; margin-top: 1em"><b>The
Undefined card application
&lsquo;&lsquo;undefined&rsquo;&rsquo; &nbsp;</b></p>

<p style="margin-left:11%; margin-top: 1em">This is a stub
application to allow the use of the APDU command even if no
supported application is found on the card. This application
is not used automatically but must be explicitly requested
using the SERIALNO command.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:14%; margin-top: 1em">$ scdaemon
--server -v</p>

<h2>FILES
<a name="FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">There are a few
configuration files to control certain aspects of
<b>scdaemons</b>&rsquo;s operation. Unless noted, they are
expected in the current home directory (see: [option
--homedir]). <b><br>
scdaemon.conf</b></p>

<p style="margin-left:22%;">This is the standard
configuration file read by <b>scdaemon</b> on startup. It
may contain any valid long option; the leading two dashes
may not be entered and the option may not be abbreviated.
This default name may be changed on the command line (see:
[option --options]).</p>

<p style="margin-left:11%;"><b>scd-event</b></p>

<p style="margin-left:22%;">If this file is present and
executable, it will be called on every card reader&rsquo;s
status change. An example of this script is provided with
the distribution</p>


<p style="margin-left:11%;"><b>reader_</b><i>n</i>.status</p>

<p style="margin-left:22%;">This file is created by
<b>scdaemon</b> to let other applications now about reader
status changes. Its use is now deprecated in favor of
&lsquo;<i>scd-event</i>&rsquo;.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>gpg-agent</b>(1),
<b>gpgsm</b>(1), <b>gpg2</b>(1)</p>

<p style="margin-left:11%; margin-top: 1em">The full
documentation for this tool is maintained as a Texinfo
manual. If GnuPG and the info program are properly installed
at your site, the command</p>

<p style="margin-left:14%; margin-top: 1em">info gnupg</p>

<p style="margin-left:11%; margin-top: 1em">should give you
access to the complete manual including a menu structure and
an index.</p>
<hr>
</body>
</html>
