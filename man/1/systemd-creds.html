<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:54:02 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>SYSTEMD&minus;CREDS</title>

</head>
<body>
<h1>systemd-creds</h1>



<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">systemd-creds
&minus; Lists, shows, encrypts and decrypts service
credentials</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="67%">


<p style="margin-top: 1em"><b>systemd&minus;creds</b>
[OPTIONS...] COMMAND [ARGS...]</p></td>
<td width="22%">
</td></tr>
</table>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>systemd&minus;creds</b>
is a tool for listing, showing, encrypting and decrypting
unit credentials. Credentials are limited&minus;size binary
or textual objects that may be passed to unit processes.
They are primarily used for passing cryptographic keys (both
public and private) or certificates, user account
information or identity information from the host to
services.</p>

<p style="margin-left:11%; margin-top: 1em">Credentials are
configured in unit files via the <i>LoadCredential=</i>,
<i>SetCredential=</i>, <i>LoadCredentialEncrypted=</i> and
<i>SetCredentialEncrypted=</i> settings, see
<b>systemd.exec</b>(5) for details.</p>

<p style="margin-left:11%; margin-top: 1em">For further
information see <b><font color="#0000FF">System and Service
Credentials</font></b>
<small><font color="#000000">[1]</font></small>
<font color="#000000">documentation.</font></p>

<h2>COMMANDS
<a name="COMMANDS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
following commands are understood:</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>list</b></font></p>

<p style="margin-left:17%;"><font color="#000000">Show a
list of credentials passed into the current execution
context. This command shows the files in the directory
referenced by the <i>$CREDENTIALS_DIRECTORY</i> environment
variable, and is intended to be executed from within service
context.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Along
with each credential name, the size and security state is
shown. The latter is one of &quot;secure&quot; (in case the
credential is backed by unswappable memory, i.e.
&quot;ramfs&quot;), &quot;weak&quot; (in case it is backed
by any other type of memory), or &quot;insecure&quot; (if
having any access mode that is not 0400, i.e. if readable by
anyone but the owner).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>cat</b>
<i>credential...</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Show
contents of specified credentials passed into the current
execution context. Takes one or more credential names, whose
contents shall be written to standard output.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
combined with <b>&minus;&minus;json=</b> or
<b>&minus;&minus;transcode=</b> the output is transcoded in
simple ways before outputting.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>setup</b></font></p>


<p style="margin-left:17%;"><font color="#000000">Generates
a host encryption key for credentials, if one has not been
generated already. This ensures the
/var/lib/systemd/credential.secret file is initialized with
a random secret key if it doesn't exist yet. This secret key
is used when encrypting/decrypting credentials with
<b>encrypt</b> or <b>decrypt</b>, and is only accessible to
the root user. Note that there's typically no need to invoke
this command explicitly as it is implicitly called when
<b>encrypt</b> is invoked, and credential host key
encryption selected.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>encrypt</b>
<i>input|&minus; output|&minus;</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Loads the
specified (unencrypted plaintext) input credential file,
encrypts it and writes the (encrypted ciphertext) output to
the specified target credential file. The resulting file may
be referenced in the <i>LoadCredentialEncrypted=</i> setting
in unit files, or its contents used literally in
<i>SetCredentialEncrypted=</i> settings.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Takes
two file system paths. The file name part of the output path
is embedded as name in the encrypted credential, to ensure
encrypted credentials cannot be renamed and reused for
different purposes without this being noticed. The
credential name to embed may be overridden with the
<b>&minus;&minus;name=</b> setting. The input or output
paths may be specified as &quot;&minus;&quot;, in which case
the credential data is read from/written to standard input
and standard output. If the output path is specified as
&quot;&minus;&quot; the credential name cannot be derived
from the file system path, and thus should be specified
explicitly via the <b>&minus;&minus;name=</b>
switch.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
credential data is encrypted and authenticated symmetrically
with one of the following encryption keys:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">1.
A secret key automatically derived from the system's TPM2
chip. This encryption key is not stored on the host system
and thus decryption is only possible with access to the
original TPM2 chip. Or in other words, the credential
secured in this way can only be decrypted again by the local
machine.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">2.
A secret key stored in the
/var/lib/systemd/credential.secret file which is only
accessible to the root user. This &quot;host&quot;
encryption key is stored on the host file system, and thus
decryption is possible with access to the host file system
and sufficient privileges. The key is automatically
generated when needed, but can also be created explicitly
with the <b>setup</b> command, see above.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">3.
A combination of the above: an encryption key derived from
both the TPM2 chip and the host file system. This means
decryption requires both access to the original TPM2 chip
and the OS installation. This is the default mode of
operation if a TPM2 chip is available and /var/lib/systemd/
resides on persistent media.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Which
of the three keys shall be used for encryption may be
configured with the <b>&minus;&minus;with&minus;key=</b>
switch. Depending on the use&minus;case for the encrypted
credential the key to use may differ. For example, for
credentials that shall be accessible from the initrd,
encryption with the host key is not appropriate, since
access to the host key is typically not available from the
initrd. Thus, for such credentials only the TPM2 key should
be used.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Encrypted
credentials are always encoded in Base64.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Use
<b>decrypt</b> (see below) to undo the encryption operation,
and acquire the decrypted plaintext credential from the
encrypted ciphertext credential.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
credential data is encrypted using AES256&minus;GCM, i.e.
providing both confidentiality and integrity, keyed by a
SHA256 hash of one or both of the secret keys described
above.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>decrypt</b>
<i>input|&minus;</i> [<i>output|&minus;</i>]</font></p>

<p style="margin-left:17%;"><font color="#000000">Undoes
the effect of the <b>encrypt</b> operation: loads the
specified (encrypted ciphertext) input credential file,
decrypts and authenticates it and writes the (decrypted
plaintext) output to the specified target credential
file.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Takes
one or two file system paths. The file name part of the
input path is compared with the credential name embedded in
the encrypted file. If it does not match decryption fails.
This is done in order to ensure that encrypted credentials
are not re&minus;purposed without this being detected. The
credential name to compare with the embedded credential name
may also be overridden with the <b>&minus;&minus;name=</b>
switch. If the input path is specified as
&quot;&minus;&quot;, the encrypted credential is read from
standard input. If only one path is specified or the output
path specified as &quot;&minus;&quot;, the decrypted
credential is written to standard output. In this mode, the
expected name embedded in the credential cannot be derived
from the path and should be specified explicitly with
<b>&minus;&minus;name=</b>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Decrypting
credentials requires access to the original TPM2 chip and/or
credentials host key, see above. Information about which
keys are required is embedded in the encrypted credential
data, and thus decryption is entirely automatic.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>has&minus;tpm2</b></font></p>

<p style="margin-left:17%;"><font color="#000000">Reports
whether the system is equipped with a TPM2 device usable for
protecting credentials. If a TPM2 device has been
discovered, is supported, and is being used by firmware, by
the OS kernel drivers and by userspace (i.e. systemd) this
prints &quot;yes&quot; and exits with exit status zero. If
no such device is discovered/supported/used, prints
&quot;no&quot;. Otherwise prints &quot;partial&quot;. In
either of these two cases exits with non&minus;zero exit
status. It also shows four lines indicating separately
whether firmware, drivers, the system and the kernel
discovered/support/use TPM2.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Combine
with <b>&minus;&minus;quiet</b> to suppress the
output.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;h</b>,
<b>&minus;&minus;help</b></font></p>

<p style="margin-left:17%;"><font color="#000000">Print a
short help text and exit.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;version</b></font></p>

<p style="margin-left:17%;"><font color="#000000">Print a
short version string and exit.</font></p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;system</b></font></p>

<p style="margin-left:17%;"><font color="#000000">When
specified with the <b>list</b> and <b>cat</b> commands
operates on the credentials passed to system as a whole
instead of on those passed to the current execution context.
This is useful in container environments where credentials
may be passed in from the container manager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;transcode=</b></font></p>

<p style="margin-left:17%;"><font color="#000000">When
specified with the <b>cat</b> or <b>decrypt</b> commands,
transcodes the output before showing it. Takes one of
&quot;base64&quot;, &quot;unbase64&quot;, &quot;hex&quot; or
&quot;unhex&quot; as argument, in order to encode/decode the
credential data with Base64 or as series of hexadecimal
values.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
that this has no effect on the <b>encrypt</b> command, as
encrypted credentials are unconditionally encoded in
Base64.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;newline=</b></font></p>

<p style="margin-left:17%;"><font color="#000000">When
specified with <b>cat</b> or <b>decrypt</b> controls whether
to add a trailing newline character to the end of the output
if it doesn't end in one, anyway. Takes one of
&quot;auto&quot;, &quot;yes&quot; or &quot;no&quot;. The
default mode of &quot;auto&quot; will suffix the output with
a single newline character only when writing credential data
to a TTY.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;pretty</b>,
<b>&minus;p</b></font></p>

<p style="margin-left:17%;"><font color="#000000">When
specified with <b>encrypt</b> controls whether to show the
encrypted credential as <i>SetCredentialEncrypted=</i>
setting that may be pasted directly into a unit
file.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;name=</b><i>name</i></font></p>

<p style="margin-left:17%;"><font color="#000000">When
specified with the <b>encrypt</b> command controls the
credential name to embed in the encrypted credential data.
If not specified the name is chosen automatically from the
filename component of the specified output path. If
specified as empty string no credential name is embedded in
the encrypted credential, and no verification of credential
name is done when the credential is decrypted.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
specified with the <b>decrypt</b> command control the
credential name to validate the credential name embedded in
the encrypted credential with. If not specified the name is
chosen automatically from the filename component of the
specified input path. If no credential name is embedded in
the encrypted credential file (i.e. the
<b>&minus;&minus;name=</b> with an empty string was used
when encrypted) the specified name has no effect as no
credential name validation is done.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Embedding
the credential name in the encrypted credential is done in
order to protect against reuse of credentials for purposes
they weren't originally intended for, under the assumption
the credential name is chosen carefully to encode its
intended purpose.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;timestamp=</b><i>timestamp</i></font></p>

<p style="margin-left:17%;"><font color="#000000">When
specified with the <b>encrypt</b> command controls the
timestamp to embed into the encrypted credential. Defaults
to the current time. Takes a timestamp specification in the
format described in <b>systemd.time</b>(7).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
specified with the <b>decrypt</b> command controls the
timestamp to use to validate the &quot;not&minus;after&quot;
timestamp that was configured with
<b>&minus;&minus;not&minus;after=</b> during encryption. If
not specified defaults to the current system
time.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;not&minus;after=</b><i>timestamp</i></font></p>

<p style="margin-left:17%;"><font color="#000000">When
specified with the <b>encrypt</b> command controls the time
when the credential shall not be used anymore. This embeds
the specified timestamp in the encrypted credential. During
decryption the timestamp is checked against the current
system clock, and if the timestamp is in the past the
decryption will fail. By default no such timestamp is set.
Takes a timestamp specification in the format described in
<b>systemd.time</b>(7).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;with&minus;key=</b>,
<b>&minus;H</b>, <b>&minus;T</b></font></p>

<p style="margin-left:17%;"><font color="#000000">When
specified with the <b>encrypt</b> command controls the
encryption/signature key to use. Takes one of
&quot;host&quot;, &quot;tpm2&quot;, &quot;host+tpm2&quot;,
&quot;tpm2&minus;absent&quot;, &quot;auto&quot;,
&quot;auto&minus;initrd&quot;. See above for details on the
three key types. If set to &quot;auto&quot; (which is the
default) the TPM2 key is used if a TPM2 device is found and
not running in a container. The host key is used if
/var/lib/systemd/ is on persistent media. This means on
typical systems the encryption is by default bound to both
the TPM2 chip and the OS installation, and both need to be
available to decrypt the credential again. If
&quot;auto&quot; is selected but neither TPM2 is available
(or running in container) nor /var/lib/systemd/ is on
persistent media, encryption will fail. If set to
&quot;tpm2&minus;absent&quot; a fixed zero length key is
used (thus, in this mode no confidentiality nor authenticity
are provided!). This logic is useful to cover for systems
that lack a TPM2 chip but where credentials shall be
generated. Note that decryption of such credentials is
refused on systems that have a TPM2 chip and where UEFI
SecureBoot is enabled (this is done so that such a locked
down system cannot be tricked into loading a credential
generated this way that lacks authentication information).
If set to &quot;auto&minus;initrd&quot; a TPM2 key is used
if a TPM2 is found. If not a fixed zero length key is used,
equivalent to &quot;tpm2&minus;absent&quot; mode. This
option is particularly useful to generate credentials files
that are encrypted/authenticated against TPM2 where
available but still work on systems lacking support for
this.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
<b>&minus;H</b> switch is a shortcut for
<b>&minus;&minus;with&minus;key=host</b>. Similar,
<b>&minus;T</b> is a shortcut for
<b>&minus;&minus;with&minus;key=tpm2</b>.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">When
encrypting credentials that shall be used in the initrd
(where /var/lib/systemd/ is typically not available) make
sure to use
<b>&minus;&minus;with&minus;key=auto&minus;initrd</b> mode,
to disable binding against the host secret.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
switch has no effect on the <b>decrypt</b> command, as
information on which key to use for decryption is included
in the encrypted credential already.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;tpm2&minus;device=</b><i>PATH</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Controls
the TPM2 device to use. Expects a device node path referring
to the TPM2 chip (e.g. /dev/tpmrm0). Alternatively the
special value &quot;auto&quot; may be specified, in order to
automatically determine the device node of a suitable TPM2
device (of which there must be exactly one). The special
value &quot;list&quot; may be used to enumerate all suitable
TPM2 devices currently discovered.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;tpm2&minus;pcrs=</b>
[PCR...]</font></p>


<p style="margin-left:17%;"><font color="#000000">Configures
the TPM2 PCRs (Platform Configuration Registers) to bind the
encryption key to. Takes a &quot;+&quot; separated list of
numeric PCR indexes in the range 0...23. If not used,
defaults to PCR 7 only. If an empty string is specified,
binds the encryption key to no PCRs at all. For details
about the PCRs available, see the documentation of the
switch of the same name for
<b>systemd-cryptenroll</b>(1).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;tpm2&minus;public&minus;key=</b>
[PATH],
<b>&minus;&minus;tpm2&minus;public&minus;key&minus;pcrs=</b>
[PCR...]</font></p>


<p style="margin-left:17%;"><font color="#000000">Configures
a TPM2 signed PCR policy to bind encryption to, for use with
the <b>encrypt</b> command. The
<b>&minus;&minus;tpm2&minus;public&minus;key=</b> option
accepts a path to a PEM encoded RSA public key, to bind the
encryption to. If this is not specified explicitly, but a
file tpm2&minus;pcr&minus;public&minus;key.pem exists in one
of the directories /etc/systemd/, /run/systemd/,
/usr/lib/systemd/ (searched in this order), it is
automatically used. The
<b>&minus;&minus;tpm2&minus;public&minus;key&minus;pcrs=</b>
option takes a list of TPM2 PCR indexes to bind to (same
syntax as <b>&minus;&minus;tpm2&minus;pcrs=</b> described
above). If not specified defaults to 11 (i.e. this binds the
policy to any unified kernel image for which a PCR signature
can be provided).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Note
the difference between <b>&minus;&minus;tpm2&minus;pcrs=</b>
and
<b>&minus;&minus;tpm2&minus;public&minus;key&minus;pcrs=</b>:
the former binds decryption to the current, specific PCR
values; the latter binds decryption to any set of PCR values
for which a signature by the specified public key can be
provided. The latter is hence more useful in scenarios where
software updates shall be possible without losing access to
all previously encrypted secrets.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;tpm2&minus;signature=</b>
[PATH]</font></p>

<p style="margin-left:17%;"><font color="#000000">Takes a
path to a TPM2 PCR signature file as generated by the
<b>systemd-measure</b>(1) tool and that may be used to allow
the <b>decrypt</b> command to decrypt credentials that are
bound to specific signed PCR values. If this is not
specified explicitly, and a credential with a signed PCR
policy is attempted to be decrypted, a suitable signature
file tpm2&minus;pcr&minus;signature.json is searched for in
/etc/systemd/, /run/systemd/, /usr/lib/systemd/ (in this
order) and used.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;quiet</b>,
<b>&minus;q</b></font></p>

<p style="margin-left:17%;"><font color="#000000">When used
with <b>has&minus;tpm2</b> suppresses the output, and only
returns an exit status indicating support for
TPM2.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;no&minus;pager</b></font></p>

<p style="margin-left:17%;"><font color="#000000">Do not
pipe output into a pager.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;no&minus;legend</b></font></p>

<p style="margin-left:17%;"><font color="#000000">Do not
print the legend, i.e. column headers and the footer with
hints.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>&minus;&minus;json=</b><i>MODE</i></font></p>

<p style="margin-left:17%;"><font color="#000000">Shows
output formatted as JSON. Expects one of &quot;short&quot;
(for the shortest possible output without any redundant
whitespace or line breaks), &quot;pretty&quot; (for a pretty
version of the same, with indentation and line breaks) or
&quot;off&quot; (to turn off JSON output, the
default).</font></p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">On
success, 0 is returned.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">In
case of the <b>has&minus;tpm2</b> command returns 0 if a
TPM2 device is discovered, supported and used by firmware,
driver, and userspace (i.e. systemd). Otherwise returns the
OR combination of the value 1 (in case firmware support is
missing), 2 (in case driver support is missing) and 4 (in
case userspace support is missing). If no TPM2 support is
available at all, value 7 is hence returned.</font></p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Example&nbsp;1.&nbsp;Encrypt
a password for use as credential</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
following command line encrypts the specified password
&quot;hunter2&quot;, writing the result to a file
password.cred.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">#
echo &minus;n hunter2 | systemd&minus;creds encrypt &minus;
password.cred</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">This
decrypts the file password.cred again, revealing the literal
password:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">#
systemd&minus;creds decrypt password.cred <br>
hunter2</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Example&nbsp;2.&nbsp;Encrypt
a password and include it in a unit file</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
following command line prompts the user for a password and
generates a <i>SetCredentialEncrypted=</i> line from it for
a credential named &quot;mysql&minus;password&quot;,
suitable for inclusion in a unit file.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">#
systemd&minus;ask&minus;password &minus;n |
systemd&minus;creds encrypt
&minus;&minus;name=mysql&minus;password &minus;p &minus;
&minus; <br>
&eth; Password: **** <br>
SetCredentialEncrypted=mysql&minus;password: \ <br>

k6iUCUh0RJCQyvL8k8q1UyAAAAABAAAADAAAABAAAAASfFsBoPLIm/dlDoGAAAAAAAAAA
\ <br>

NAAAAAgAAAAAH4AILIOZ3w6rTzYsBy9G7liaCAd4i+Kpvs8mAgArzwuKxd0ABDjgSeO5k
\ <br>

mKQc58zM94ZffyRmuNeX1lVHE+9e2YD87KfRFNoDLS7F3YmCb347gCiSk2an9egZ7Y0Xs
\ <br>

700Kr6heqQswQEemNEc62k9RJnEl2q7SbcEYguegnPQUATgAIAAsAAAASACA/B90W7E+6
\ <br>

yAR9NgiIJvxr9bpElztwzB5lUJAxtMBHIgAQACCaSV9DradOZz4EvO/LSaRyRSq2Hj0ym
\ <br>

gVJk/dVzE8Uxj8H3RbsT7rIBH02CIgm/Gv1ukSXO3DMHmVQkDG0wEciyageTfrVEer8z5
\ <br>

9cUQfM5ynSaV2UjeUWEHuz4fwDsXGLB9eELXLztzUU9nsAyLvs3ZRR+eEK/A==</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
generated line can be pasted 1:1 into a unit file, and will
ensure the acquired password will be made available in the
<i>$CREDENTIALS_DIRECTORY</i>/mysql&minus;password
credential file for the started service.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Utilizing
the unit file drop&minus;in logic this can be used to
securely pass a password credential to a unit. A similar,
more comprehensive set of commands to insert a password into
a service xyz.service:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">#
mkdir &minus;p /etc/systemd/system/xyz.service.d <br>
# systemd&minus;ask&minus;password &minus;n |
systemd&minus;creds encrypt
&minus;&minus;name=mysql&minus;password &minus;p &minus;
&minus;
&gt;/etc/systemd/system/xyz.service.d/50&minus;password.conf
<br>
# systemctl daemon&minus;reload <br>
# systemctl restart xyz.service</font></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>systemd</b>(1),
<b>systemd.exec</b>(5), <b>systemd-measure</b>(1)</font></p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">1.</font></p> </td>
<td width="2%"></td>
<td width="46%">


<p style="margin-top: 1em"><font color="#000000">System and
Service Credentials</font></p></td>
<td width="37%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://systemd.io/CREDENTIALS</font></p>
<hr>
</body>
</html>
