<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:56:53 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>FOLDERS</title>

</head>
<body>
<h1>folders</h1>



<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>folders</b>
&minus; Folder Structures Used by npm</p>


<p style="margin-left:11%; margin-top: 1em"><b>Description</b>
<br>
npm puts various things on your computer. That&rsquo;s its
job.</p>

<p style="margin-left:11%; margin-top: 1em">This document
will tell you what it puts where.</p>


<p style="margin-left:11%; margin-top: 1em"><b>tl;dr</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p>Local install (default): puts stuff in
<b>./node_modules</b> of the current package root.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p>Global install (with <b>&minus;g</b>): puts stuff in
/usr/local or wherever node is installed.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p>Install it <b>locally</b> if you&rsquo;re going to
<b>require()</b> it.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p>Install it <b>globally</b> if you&rsquo;re going to run
it on the command line.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="86%">


<p>If you need both, then install it in both places, or use
<b>npm link</b>.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>prefix
Configuration</b> <br>
The <b>prefix</b> config defaults to the location where node
is installed. On most systems, this is <b>/usr/local</b>. On
Windows, it&rsquo;s <b>%AppData%\npm</b>. On Unix systems,
it&rsquo;s one level up, since node is typically installed
at <b>{prefix}/bin/node</b> rather than
<b>{prefix}/node.exe</b>.</p>

<p style="margin-left:11%; margin-top: 1em">When the
<b>global</b> flag is set, npm installs things into this
prefix. When it is not set, it uses the root of the current
package, or the current working directory if not in a
package already.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Node
Modules</b> <br>
Packages are dropped into the <b>node_modules</b> folder
under the <b>prefix</b>. When installing locally, this means
that you can <b>require(&quot;packagename&quot;)</b> to load
its main module, or
<b>require(&quot;packagename/lib/path/to/sub/module&quot;)</b>
to load other modules.</p>

<p style="margin-left:11%; margin-top: 1em">Global installs
on Unix systems go to <b>{prefix}/lib/node_modules</b>.
Global installs on Windows go to
<b>{prefix}/node_modules</b> (that is, no <b>lib</b>
folder.)</p>

<p style="margin-left:11%; margin-top: 1em">Scoped packages
are installed the same way, except they are grouped together
in a sub&minus;folder of the relevant <b>node_modules</b>
folder with the name of that scope prefix by the @ symbol,
e.g. <b>npm install @myorg/package</b> would place the
package in <b>{prefix}/node_modules/@myorg/package</b>. See
npm help <b>scope</b> for more details.</p>

<p style="margin-left:11%; margin-top: 1em">If you wish to
<b>require()</b> a package, then install it locally.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Executables</b>
<br>
When in global mode, executables are linked into
<b>{prefix}/bin</b> on Unix, or directly into
<b>{prefix}</b> on Windows. Ensure that path is in your
terminal&rsquo;s <b>PATH</b> environment to run them.</p>

<p style="margin-left:11%; margin-top: 1em">When in local
mode, executables are linked into <b>./node_modules/.bin</b>
so that they can be made available to scripts run through
npm. (For example, so that a test runner will be in the path
when you run <b>npm test</b>.)</p>

<p style="margin-left:11%; margin-top: 1em"><b>Man
Pages</b> <br>
When in global mode, man pages are linked into
<b>{prefix}/share/man</b>.</p>

<p style="margin-left:11%; margin-top: 1em">When in local
mode, man pages are not installed.</p>

<p style="margin-left:11%; margin-top: 1em">Man pages are
not installed on Windows systems.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Cache</b>
<br>
See npm help <b>cache</b>. Cache files are stored in
<b>~/.npm</b> on Posix, or <b>%AppData%/npm&minus;cache</b>
on Windows.</p>

<p style="margin-left:11%; margin-top: 1em">This is
controlled by the <b>cache</b> configuration param.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Temp
Files</b> <br>
Temporary files are stored by default in the folder
specified by the <b>tmp</b> config, which defaults to the
TMPDIR, TMP, or TEMP environment variables, or <b>/tmp</b>
on Unix and <b>c:\windows\temp</b> on Windows.</p>

<p style="margin-left:11%; margin-top: 1em">Temp files are
given a unique folder under this root for each run of the
program, and are deleted upon successful exit.</p>

<p style="margin-left:11%; margin-top: 1em"><b>More
Information</b> <br>
When installing locally, npm first tries to find an
appropriate <b>prefix</b> folder. This is so that <b>npm
install foo@1.2.3</b> will install to the sensible root of
your package, even if you happen to have <b>cd</b>ed into
some other folder.</p>

<p style="margin-left:11%; margin-top: 1em">Starting at the
$PWD, npm will walk up the folder tree checking for a folder
that contains either a <b>package.json</b> file, or a
<b>node_modules</b> folder. If such a thing is found, then
that is treated as the effective &quot;current
directory&quot; for the purpose of running npm commands.
(This behavior is inspired by and similar to git&rsquo;s
.git&minus;folder seeking logic when running git commands in
a working dir.)</p>

<p style="margin-left:11%; margin-top: 1em">If no package
root is found, then the current folder is used.</p>

<p style="margin-left:11%; margin-top: 1em">When you run
<b>npm install foo@1.2.3</b>, then the package is loaded
into the cache, and then unpacked into
<b>./node_modules/foo</b>. Then, any of foo&rsquo;s
dependencies are similarly unpacked into
<b>./node_modules/foo/node_modules/...</b>.</p>

<p style="margin-left:11%; margin-top: 1em">Any bin files
are symlinked to <b>./node_modules/.bin/</b>, so that they
may be found by npm scripts when necessary.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Global
Installation</b> <br>
If the <b>global</b> configuration is set to true, then npm
will install packages &quot;globally&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">For global
installation, packages are installed roughly the same way,
but using the folders described above.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Cycles,
Conflicts, and Folder Parsimony</b> <br>
Cycles are handled using the property of node&rsquo;s module
system that it walks up the directories looking for
<b>node_modules</b> folders. So, at every stage, if a
package is already installed in an ancestor
<b>node_modules</b> folder, then it is not installed at the
current location.</p>

<p style="margin-left:11%; margin-top: 1em">Consider the
case above, where <b>foo &minus;&gt; bar &minus;&gt;
baz</b>. Imagine if, in addition to that, baz depended on
bar, so you&rsquo;d have: <b>foo &minus;&gt; bar &minus;&gt;
baz &minus;&gt; bar &minus;&gt; baz ...</b>. However, since
the folder structure is:
<b>foo/node_modules/bar/node_modules/baz</b>, there&rsquo;s
no need to put another copy of bar into
<b>.../baz/node_modules</b>, since when it calls
require(&quot;bar&quot;), it will get the copy that is
installed in <b>foo/node_modules/bar</b>.</p>

<p style="margin-left:11%; margin-top: 1em">This shortcut
is only used if the exact same version would be installed in
multiple nested <b>node_modules</b> folders. It is still
possible to have <b>a/node_modules/b/node_modules/a</b> if
the two &quot;a&quot; packages are different versions.
However, without repeating the exact same package multiple
times, an infinite regress will always be prevented.</p>

<p style="margin-left:11%; margin-top: 1em">Another
optimization can be made by installing dependencies at the
highest level possible, below the localized
&quot;target&quot; folder.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Example</b>
<br>
Consider this dependency graph:</p>

<p style="margin-left:14%; margin-top: 1em">foo <br>
+&minus;&minus; blerg@1.2.5 <br>
+&minus;&minus; bar@1.2.3 <br>
| +&minus;&minus; blerg@1.x (latest=1.3.7) <br>
| +&minus;&minus; baz@2.x <br>
| | &lsquo;&minus;&minus; quux@3.x <br>
| | &lsquo;&minus;&minus; bar@1.2.3 (cycle) <br>
| &lsquo;&minus;&minus; asdf@* <br>
&lsquo;&minus;&minus; baz@1.2.3 <br>
&lsquo;&minus;&minus; quux@3.x <br>
&lsquo;&minus;&minus; bar</p>

<p style="margin-left:11%; margin-top: 1em">In this case,
we might expect a folder structure like this:</p>

<p style="margin-left:14%; margin-top: 1em">foo <br>
+&minus;&minus; node_modules <br>
+&minus;&minus; blerg (1.2.5) &lt;&minus;&minus;&minus;[A]
<br>
+&minus;&minus; bar (1.2.3) &lt;&minus;&minus;&minus;[B]
<br>
| &lsquo;&minus;&minus; node_modules <br>
| +&minus;&minus; baz (2.0.2) &lt;&minus;&minus;&minus;[C]
<br>
| | &lsquo;&minus;&minus; node_modules <br>
| | &lsquo;&minus;&minus; quux (3.2.0) <br>
| &lsquo;&minus;&minus; asdf (2.3.4) <br>
&lsquo;&minus;&minus; baz (1.2.3)
&lt;&minus;&minus;&minus;[D] <br>
&lsquo;&minus;&minus; node_modules <br>
&lsquo;&minus;&minus; quux (3.2.0)
&lt;&minus;&minus;&minus;[E]</p>

<p style="margin-left:11%; margin-top: 1em">Since foo
depends directly on <b>bar@1.2.3</b> and <b>baz@1.2.3</b>,
those are installed in foo&rsquo;s <b>node_modules</b>
folder.</p>

<p style="margin-left:11%; margin-top: 1em">Even though the
latest copy of blerg is 1.3.7, foo has a specific dependency
on version 1.2.5. So, that gets installed at [A]. Since the
parent installation of blerg satisfies bar&rsquo;s
dependency on <b>blerg@1.x</b>, it does not install another
copy under [B].</p>

<p style="margin-left:11%; margin-top: 1em">Bar [B] also
has dependencies on baz and asdf, so those are installed in
bar&rsquo;s <b>node_modules</b> folder. Because it depends
on <b>baz@2.x</b>, it cannot re&minus;use the
<b>baz@1.2.3</b> installed in the parent <b>node_modules</b>
folder [D], and must install its own copy [C].</p>

<p style="margin-left:11%; margin-top: 1em">Underneath bar,
the <b>baz &minus;&gt; quux &minus;&gt; bar</b> dependency
creates a cycle. However, because bar is already in
quux&rsquo;s ancestry [B], it does not unpack another copy
of bar into that folder.</p>

<p style="margin-left:11%; margin-top: 1em">Underneath
<b>foo &minus;&gt; baz</b> [D], quux&rsquo;s [E] folder tree
is empty, because its dependency on bar is satisfied by the
parent folder copy installed at [B].</p>

<p style="margin-left:11%; margin-top: 1em">For a graphical
breakdown of what is installed where, use <b>npm ls</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Publishing</b>
<br>
Upon publishing, npm will look in the <b>node_modules</b>
folder. If any of the items there are not in the
<b>bundleDependencies</b> array, then they will not be
included in the package tarball.</p>

<p style="margin-left:11%; margin-top: 1em">This allows a
package maintainer to install all of their dependencies (and
dev dependencies) locally, but only re&minus;publish those
items that cannot be found elsewhere. See npm help
<b>package.json</b> for more information.</p>

<p style="margin-left:11%; margin-top: 1em"><b>See
also</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p style="margin-top: 1em">npm help package.json</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>npm help install</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>npm help pack</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>npm help cache</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>npm help config</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>npm help npmrc</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>npm help config</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>npm help publish</p></td>
<td width="54%">
</td></tr>
 </table>
<hr>
</body>
</html>
