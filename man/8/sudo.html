<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:57:08 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>
<h1>sudo</h1>

<hr>


<p>SUDO(8) BSD System Manager&rsquo;s Manual SUDO(8)</p>

<p style="margin-top: 1em"><b>NAME</b></p>

<p style="margin-left:6%;"><b>sudo</b>, <b>sudoedit</b>
&mdash; execute a command as another user</p>

<p style="margin-top: 1em"><b>SYNOPSIS</b></p>

<p style="margin-left:13%;"><b>sudo &minus;h</b> |
<b>&minus;K</b> | <b>&minus;k</b> | <b>&minus;V <br>
sudo &minus;v</b> [<b>&minus;ABkNnS</b>]
[<b>&minus;g&nbsp;</b><i>group</i>]
[<b>&minus;h&nbsp;</b><i>host</i>]
[<b>&minus;p&nbsp;</b><i>prompt</i>]
[<b>&minus;u&nbsp;</b><i>user</i>] <b><br>
sudo &minus;l</b> [<b>&minus;ABkNnS</b>]
[<b>&minus;g&nbsp;</b><i>group</i>]
[<b>&minus;h&nbsp;</b><i>host</i>]
[<b>&minus;p&nbsp;</b><i>prompt</i>]
[<b>&minus;U&nbsp;</b><i>user</i>]
[<b>&minus;u&nbsp;</b><i>user</i>]
[<i>command&nbsp;</i>[<i>arg&nbsp;...</i>]] <b><br>
sudo</b> [<b>&minus;ABbEHnPS</b>]
[<b>&minus;C&nbsp;</b><i>num</i>]
[<b>&minus;D&nbsp;</b><i>directory</i>]
[<b>&minus;g&nbsp;</b><i>group</i>]
[<b>&minus;h&nbsp;</b><i>host</i>]
[<b>&minus;p&nbsp;</b><i>prompt</i>]
[<b>&minus;R&nbsp;</b><i>directory</i>]
[<b>&minus;T&nbsp;</b><i>timeout</i>]
[<b>&minus;u&nbsp;</b><i>user</i>] [<i>VAR</i>=<i>value</i>]
[<b>&minus;i&nbsp;</b>|&nbsp;<b>&minus;s</b>]
[<i>command&nbsp;</i>[<i>arg&nbsp;...</i>]] <b><br>
sudoedit</b> [<b>&minus;ABkNnS</b>]
[<b>&minus;C&nbsp;</b><i>num</i>]
[<b>&minus;D&nbsp;</b><i>directory</i>]
[<b>&minus;g&nbsp;</b><i>group</i>]
[<b>&minus;h&nbsp;</b><i>host</i>]
[<b>&minus;p&nbsp;</b><i>prompt</i>]
[<b>&minus;R&nbsp;</b><i>directory</i>]
[<b>&minus;T&nbsp;</b><i>timeout</i>]
[<b>&minus;u&nbsp;</b><i>user</i>] <i>file&nbsp;...</i></p>

<p style="margin-top: 1em"><b>DESCRIPTION</b></p>

<p style="margin-left:6%;"><b>sudo</b> allows a permitted
user to execute a <i>command</i> as the superuser or another
user, as specified by the security policy. The invoking
user&rsquo;s real (<i>not</i> effective) user-ID is used to
determine the user name with which to query the security
policy.</p>

<p style="margin-left:6%; margin-top: 1em"><b>sudo</b>
supports a plugin architecture for security policies,
auditing, and input/output logging. Third parties can
develop and distribute their own plugins to work seamlessly
with the <b>sudo</b> front-end. The default security policy
is <i>sudoers</i>, which is configured via the file
<i>/etc/sudoers</i>, or via LDAP. See the <i>Plugins</i>
section for more information.</p>

<p style="margin-left:6%; margin-top: 1em">The security
policy determines what privileges, if any, a user has to run
<b>sudo</b>. The policy may require that users authenticate
themselves with a password or another authentication
mechanism. If authentication is required, <b>sudo</b> will
exit if the user&rsquo;s password is not entered within a
configurable time limit. This limit is policy-specific; the
default password prompt timeout for the <i>sudoers</i>
security policy is 5 minutes.</p>

<p style="margin-left:6%; margin-top: 1em">Security
policies may support credential caching to allow the user to
run <b>sudo</b> again for a period of time without requiring
authentication. By default, the <i>sudoers</i> policy caches
credentials on a per-terminal basis for 5 minutes. See the
<i>timestamp_type</i> and <i>timestamp_timeout</i> options
in sudoers(5) for more information. By running <b>sudo</b>
with the <b>&minus;v</b> option, a user can update the
cached credentials without running a <i>command</i>.</p>

<p style="margin-left:6%; margin-top: 1em">On systems where
<b>sudo</b> is the primary method of gaining superuser
privileges, it is imperative to avoid syntax errors in the
security policy configuration files. For the default
security policy, sudoers(5), changes to the configuration
files should be made using the visudo(8) utility which will
ensure that no syntax errors are introduced.</p>

<p style="margin-left:6%; margin-top: 1em">When invoked as
<b>sudoedit</b>, the <b>&minus;e</b> option (described
below), is implied.</p>

<p style="margin-left:6%; margin-top: 1em">Security
policies and audit plugins may log successful and failed
attempts to run <b>sudo</b>. If an I/O plugin is configured,
the running <i>command</i>&rsquo;s input and output may be
logged as well.</p>

<p style="margin-left:6%; margin-top: 1em">The options are
as follows:</p>

<p style="margin-top: 1em"><b>&minus;A</b>,
<b>&minus;-askpass</b></p>

<p style="margin-left:17%;">Normally, if <b>sudo</b>
requires a password, it will read it from the user&rsquo;s
terminal. If the <b>&minus;A</b> (<i>askpass</i>) option is
specified, a (possibly graphical) helper program is executed
to read the user&rsquo;s password and output the password to
the standard output. If the SUDO_ASKPASS environment
variable is set, it specifies the path to the helper
program. Otherwise, if sudo.conf(5) contains a line
specifying the askpass program, that value will be used. For
example:</p>

<p style="margin-left:22%; margin-top: 1em"># Path to
askpass helper program <br>
Path askpass /usr/X11R6/bin/ssh-askpass</p>

<p style="margin-left:17%; margin-top: 1em">If no askpass
program is available, <b>sudo</b> will exit with an
error.</p>

<p style="margin-top: 1em"><b>&minus;B</b>,
<b>&minus;-bell</b></p>

<p style="margin-left:17%;">Ring the bell as part of the
password prompt when a terminal is present. This option has
no effect if an askpass program is used.</p>

<p style="margin-top: 1em"><b>&minus;b</b>,
<b>&minus;-background</b></p>

<p style="margin-left:17%;">Run the given <i>command</i> in
the background. It is not possible to use shell job control
to manipulate background processes started by <b>sudo</b>.
Most interactive <i>command</i>s will fail to work properly
in background mode.</p>

<p style="margin-top: 1em"><b>&minus;C</b> <i>num</i>,
<b>&minus;-close-from</b>=<i>num</i></p>

<p style="margin-left:17%;">Close all file descriptors
greater than or equal to <i>num</i> before executing a
<i>command</i>. Values less than three are not permitted. By
default, <b>sudo</b> will close all open file descriptors
other than standard input, standard output, and standard
error when executing a <i>command</i>. The security policy
may restrict the user&rsquo;s ability to use this option.
The <i>sudoers</i> policy only permits use of the
<b>&minus;C</b> option when the administrator has enabled
the <i>closefrom_override</i> option.</p>

<p style="margin-top: 1em"><b>&minus;D</b>
<i>directory</i>, <b>&minus;-chdir</b>=<i>directory</i></p>

<p style="margin-left:17%;">Run the <i>command</i> in the
specified <i>directory</i> instead of the current working
directory. The security policy may return an error if the
user does not have permission to specify the working
directory.</p>

<p style="margin-top: 1em"><b>&minus;E</b>,
<b>&minus;-preserve-env</b></p>

<p style="margin-left:17%;">Indicates to the security
policy that the user wishes to preserve their existing
environment variables. The security policy may return an
error if the user does not have permission to preserve the
environment.</p>


<p style="margin-top: 1em"><b>&minus;-preserve-env=list</b></p>

<p style="margin-left:17%;">Indicates to the security
policy that the user wishes to add the comma-separated list
of environment variables to those preserved from the
user&rsquo;s environment. The security policy may return an
error if the user does not have permission to preserve the
environment. This option may be specified multiple
times.</p>

<p style="margin-top: 1em"><b>&minus;e</b>,
<b>&minus;-edit</b></p>

<p style="margin-left:17%;">Edit one or more <i>file</i>s
instead of running a <i>command</i>. In lieu of a path name,
the string &quot;sudoedit&quot; is used when consulting the
security policy. If the user is authorized by the policy,
the following steps are taken:</p>

<p style="margin-top: 1em">1.</p>

<p style="margin-left:23%;">Temporary copies are made of
the files to be edited with the owner set to the invoking
user.</p>

<p style="margin-top: 1em">2.</p>

<p style="margin-left:23%;">The editor specified by the
policy is run to edit the temporary files. The
<i>sudoers</i> policy uses the SUDO_EDITOR, VISUAL and
EDITOR environment variables (in that order). If none of
SUDO_EDITOR, VISUAL or EDITOR are set, the first program
listed in the <i>editor</i> sudoers(5) option is used.</p>

<p style="margin-top: 1em">3.</p>

<p style="margin-left:23%;">If they have been modified, the
temporary files are copied back to their original location
and the temporary versions are removed.</p>

<p style="margin-left:17%; margin-top: 1em">To help prevent
the editing of unauthorized files, the following
restrictions are enforced unless explicitly allowed by the
security policy:</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:22%;">Symbolic links may not be
edited (version 1.8.15 and higher).</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:22%;">Symbolic links along the path
to be edited are not followed when the parent directory is
writable by the invoking user unless that user is root
(version 1.8.16 and higher).</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:22%;">Files located in a directory
that is writable by the invoking user may not be edited
unless that user is root (version 1.8.16 and higher).</p>

<p style="margin-left:17%; margin-top: 1em">Users are never
allowed to edit device special files.</p>

<p style="margin-left:17%; margin-top: 1em">If the
specified file does not exist, it will be created. Unlike
most <i>command</i>s run by <i>sudo</i>, the editor is run
with the invoking user&rsquo;s environment unmodified. If
the temporary file becomes empty after editing, the user
will be prompted before it is installed. If, for some
reason, <b>sudo</b> is unable to update a file with its
edited version, the user will receive a warning and the
edited copy will remain in a temporary file.</p>

<p style="margin-top: 1em"><b>&minus;g</b> <i>group</i>,
<b>&minus;-group</b>=<i>group</i></p>

<p style="margin-left:17%;">Run the <i>command</i> with the
primary group set to <i>group</i> instead of the primary
group specified by the target user&rsquo;s password database
entry. The <i>group</i> may be either a group name or a
numeric group-ID (GID) prefixed with the &lsquo;#&rsquo;
character (e.g., &lsquo;#0&rsquo; for GID 0). When running a
<i>command</i> as a GID, many shells require that the
&lsquo;#&rsquo; be escaped with a backslash
(&lsquo;\&rsquo;). If no <b>&minus;u</b> option is
specified, the <i>command</i> will be run as the invoking
user. In either case, the primary group will be set to
<i>group</i>. The <i>sudoers</i> policy permits any of the
target user&rsquo;s groups to be specified via the
<b>&minus;g</b> option as long as the <b>&minus;P</b> option
is not in use.</p>

<p style="margin-top: 1em"><b>&minus;H</b>,
<b>&minus;-set-home</b></p>

<p style="margin-left:17%;">Request that the security
policy set the HOME environment variable to the home
directory specified by the target user&rsquo;s password
database entry. Depending on the policy, this may be the
default behavior.</p>

<p style="margin-top: 1em"><b>&minus;h</b>,
<b>&minus;-help</b></p>

<p style="margin-left:17%;">Display a short help message to
the standard output and exit.</p>

<p style="margin-top: 1em"><b>&minus;h</b> <i>host</i>,
<b>&minus;-host</b>=<i>host</i></p>

<p style="margin-left:17%;">Run the <i>command</i> on the
specified <i>host</i> if the security policy plugin supports
remote <i>command</i>s. The <i>sudoers</i> plugin does not
currently support running remote <i>command</i>s. This may
also be used in conjunction with the <b>&minus;l</b> option
to list a user&rsquo;s privileges for the remote host.</p>

<p style="margin-top: 1em"><b>&minus;i</b>,
<b>&minus;-login</b></p>

<p style="margin-left:17%;">Run the shell specified by the
target user&rsquo;s password database entry as a login
shell. This means that login-specific resource files such as
<i>.profile</i>, <i>.bash_profile</i>, or <i>.login</i> will
be read by the shell. If a <i>command</i> is specified, it
is passed to the shell as a simple <i>command</i> using the
<b>&minus;c</b> option. The <i>command</i> and any
<i>arg</i>s are concatenated, separated by spaces, after
escaping each character (including white space) with a
backslash (&lsquo;\&rsquo;) except for alphanumerics,
underscores, hyphens, and dollar signs. If no <i>command</i>
is specified, an interactive shell is executed. <b>sudo</b>
attempts to change to that user&rsquo;s home directory
before running the shell. The <i>command</i> is run with an
environment similar to the one a user would receive at log
in. Most shells behave differently when a <i>command</i> is
specified as compared to an interactive session; consult the
shell&rsquo;s manual for details. The <i>Command
environment</i> section in the sudoers(5) manual documents
how the <b>&minus;i</b> option affects the environment in
which a <i>command</i> is run when the <i>sudoers</i> policy
is in use.</p>

<p style="margin-top: 1em"><b>&minus;K</b>,
<b>&minus;-remove-timestamp</b></p>

<p style="margin-left:17%;">Similar to the <b>&minus;k</b>
option, except that it removes every cached credential for
the user, regardless of the terminal or parent process ID.
The next time <b>sudo</b> is run, a password must be entered
if the security policy requires authentication. It is not
possible to use the <b>&minus;K</b> option in conjunction
with a <i>command</i> or other option. This option does not
require a password. Not all security policies support
credential caching.</p>

<p style="margin-top: 1em"><b>&minus;k</b>,
<b>&minus;-reset-timestamp</b></p>

<p style="margin-left:17%;">When used without a
<i>command</i>, invalidates the user&rsquo;s cached
credentials for the current session. The next time
<b>sudo</b> is run in the session, a password must be
entered if the security policy requires authentication. By
default, the <b>sudoers</b> policy uses a separate record in
the credential cache for each terminal (or parent process ID
if no terminal is present). This prevents the
<b>&minus;k</b> option from interfering with <b>sudo</b>
commands run in a different terminal session. See the
<i>timestamp_type</i> option in sudoers(5) for more
information. This option does not require a password, and
was added to allow a user to revoke <b>sudo</b> permissions
from a <i>.logout</i> file.</p>

<p style="margin-left:17%; margin-top: 1em">When used in
conjunction with a <i>command</i> or an option that may
require a password, this option will cause <b>sudo</b> to
ignore the user&rsquo;s cached credentials. As a result,
<b>sudo</b> will prompt for a password (if one is required
by the security policy) and will not update the user&rsquo;s
cached credentials.</p>

<p style="margin-left:17%; margin-top: 1em">Not all
security policies support credential caching.</p>

<p style="margin-top: 1em"><b>&minus;l</b>,
<b>&minus;-list</b></p>

<p style="margin-left:17%;">If no <i>command</i> is
specified, list the privileges for the invoking user (or the
<i>user</i> specified by the <b>&minus;U</b> option) on the
current host. A longer list format is used if this option is
specified multiple times and the security policy supports a
verbose output format.</p>

<p style="margin-left:17%; margin-top: 1em">If a
<i>command</i> is specified and is permitted by the security
policy, the fully-qualified path to the <i>command</i> is
displayed along with any <i>arg</i>s. If a <i>command</i> is
specified but not allowed by the policy, <b>sudo</b> will
exit with a status value of 1.</p>

<p style="margin-top: 1em"><b>&minus;N</b>,
<b>&minus;-no-update</b></p>

<p style="margin-left:17%;">Do not update the user&rsquo;s
cached credentials, even if the user successfully
authenticates. Unlike the <b>&minus;k</b> flag, existing
cached credentials are used if they are valid. To detect
when the user&rsquo;s cached credentials are valid (or when
no authentication is required), the following can be
used:</p>

<p style="margin-left:24%;">sudo -Nnv</p>

<p style="margin-left:17%; margin-top: 1em">Not all
security policies support credential caching.</p>

<p style="margin-top: 1em"><b>&minus;n</b>,
<b>&minus;-non-interactive</b></p>

<p style="margin-left:17%;">Avoid prompting the user for
input of any kind. If a password is required for the
<i>command</i> to run, <b>sudo</b> will display an error
message and exit.</p>

<p style="margin-top: 1em"><b>&minus;P</b>,
<b>&minus;-preserve-groups</b></p>

<p style="margin-left:17%;">Preserve the invoking
user&rsquo;s group vector unaltered. By default, the
<i>sudoers</i> policy will initialize the group vector to
the list of groups the target user is a member of. The real
and effective group-IDs, however, are still set to match the
target user.</p>

<p style="margin-top: 1em"><b>&minus;p</b> <i>prompt</i>,
<b>&minus;-prompt</b>=<i>prompt</i></p>

<p style="margin-left:17%;">Use a custom password prompt
with optional escape sequences. The following percent
(&lsquo;%&rsquo;) escape sequences are supported by the
<i>sudoers</i> policy:</p>

<p style="margin-top: 1em">%H</p>

<p style="margin-left:22%; margin-top: 1em">expanded to the
host name including the domain name (only if the
machine&rsquo;s host name is fully qualified or the
<i>fqdn</i> option is set in sudoers(5))</p>

<p style="margin-top: 1em">%h</p>

<p style="margin-left:22%; margin-top: 1em">expanded to the
local host name without the domain name</p>

<p style="margin-top: 1em">%p</p>

<p style="margin-left:22%; margin-top: 1em">expanded to the
name of the user whose password is being requested (respects
the <i>rootpw</i>, <i>targetpw</i>, and <i>runaspw</i> flags
in sudoers(5))</p>

<p style="margin-top: 1em">%U</p>

<p style="margin-left:22%; margin-top: 1em">expanded to the
login name of the user the <i>command</i> will be run as
(defaults to root unless the <b>&minus;u</b> option is also
specified)</p>

<p style="margin-top: 1em">%u</p>

<p style="margin-left:22%; margin-top: 1em">expanded to the
invoking user&rsquo;s login name</p>

<p style="margin-top: 1em">%%</p>

<p style="margin-left:22%; margin-top: 1em">two consecutive
&lsquo;%&rsquo; characters are collapsed into a single
&lsquo;%&rsquo; character</p>

<p style="margin-left:17%; margin-top: 1em">The custom
prompt will override the default prompt specified by either
the security policy or the SUDO_PROMPT environment variable.
On systems that use PAM, the custom prompt will also
override the prompt specified by a PAM module unless the
<i>passprompt_override</i> flag is disabled in
<i>sudoers</i>.</p>

<p style="margin-top: 1em"><b>&minus;R</b>
<i>directory</i>, <b>&minus;-chroot</b>=<i>directory</i></p>

<p style="margin-left:17%;">Change to the specified root
<i>directory</i> (see chroot(8)) before running the
<i>command</i>. The security policy may return an error if
the user does not have permission to specify the root
directory.</p>

<p style="margin-top: 1em"><b>&minus;S</b>,
<b>&minus;-stdin</b></p>

<p style="margin-left:17%;">Write the prompt to the
standard error and read the password from the standard input
instead of using the terminal device.</p>

<p style="margin-top: 1em"><b>&minus;s</b>,
<b>&minus;-shell</b></p>

<p style="margin-left:17%;">Run the shell specified by the
SHELL environment variable if it is set or the shell
specified by the invoking user&rsquo;s password database
entry. If a <i>command</i> is specified, it is passed to the
shell as a simple command using the <b>&minus;c</b> option.
The <i>command</i> and any <i>arg</i>s are concatenated,
separated by spaces, after escaping each character
(including white space) with a backslash (&lsquo;\&rsquo;)
except for alphanumerics, underscores, hyphens, and dollar
signs. If no <i>command</i> is specified, an interactive
shell is executed. Most shells behave differently when a
<i>command</i> is specified as compared to an interactive
session; consult the shell&rsquo;s manual for details.</p>

<p style="margin-top: 1em"><b>&minus;U</b> <i>user</i>,
<b>&minus;-other-user</b>=<i>user</i></p>

<p style="margin-left:17%;">Used in conjunction with the
<b>&minus;l</b> option to list the privileges for
<i>user</i> instead of for the invoking user. The security
policy may restrict listing other users&rsquo; privileges.
When using the <i>sudoers</i> policy, the <b>&minus;U</b>
option is restricted to the root user and users with either
the &ldquo;list&rdquo; priviege for the specified
<i>user</i> or the ability to run any <i>command</i> as root
or <i>user</i> on the current host.</p>

<p style="margin-top: 1em"><b>&minus;T</b> <i>timeout</i>,
<b>&minus;-command-timeout</b>=<i>timeout</i></p>

<p style="margin-left:17%;">Used to set a timeout for the
<i>command</i>. If the timeout expires before the
<i>command</i> has exited, the <i>command</i> will be
terminated. The security policy may restrict the
user&rsquo;s ability to set timeouts. The <i>sudoers</i>
policy requires that user-specified timeouts be explicitly
enabled.</p>

<p style="margin-top: 1em"><b>&minus;u</b> <i>user</i>,
<b>&minus;-user</b>=<i>user</i></p>

<p style="margin-left:17%;">Run the <i>command</i> as a
user other than the default target user (usually
<b>root</b>). The <i>user</i> may be either a user name or a
numeric user-ID (UID) prefixed with the &lsquo;#&rsquo;
character (e.g., &lsquo;#0&rsquo; for UID 0). When running
<i>command</i>s as a UID, many shells require that the
&lsquo;#&rsquo; be escaped with a backslash
(&lsquo;\&rsquo;). Some security policies may restrict UIDs
to those listed in the password database. The <i>sudoers</i>
policy allows UIDs that are not in the password database as
long as the <i>targetpw</i> option is not set. Other
security policies may not support this.</p>

<p style="margin-top: 1em"><b>&minus;V</b>,
<b>&minus;-version</b></p>

<p style="margin-left:17%;">Print the <b>sudo</b> version
string as well as the version string of any configured
plugins. If the invoking user is already root, the
<b>&minus;V</b> option will display the options passed to
configure when <b>sudo</b> was built; plugins may display
additional information such as default options.</p>

<p style="margin-top: 1em"><b>&minus;v</b>,
<b>&minus;-validate</b></p>

<p style="margin-left:17%;">Update the user&rsquo;s cached
credentials, authenticating the user if necessary. For the
<i>sudoers</i> plugin, this extends the <b>sudo</b> timeout
for another 5 minutes by default, but does not run a
<i>command</i>. Not all security policies support cached
credentials.</p>

<p style="margin-top: 1em"><b>&minus;&minus;</b></p>

<p style="margin-left:17%; margin-top: 1em">The
<b>&minus;&minus;</b> is used to delimit the end of the
<b>sudo</b> options. Subsequent options are passed to the
<i>command</i>.</p>

<p style="margin-left:6%; margin-top: 1em">Options that
take a value may only be specified once unless otherwise
indicated in the description. This is to help guard against
problems caused by poorly written scripts that invoke
<b>sudo</b> with user-controlled input.</p>

<p style="margin-left:6%; margin-top: 1em">Environment
variables to be set for the <i>command</i> may also be
passed as options to <b>sudo</b> in the form
<i>VAR</i>=<i>value</i>, for example
LD_LIBRARY_PATH=<i>/usr/local/pkg/lib</i>. Environment
variables may be subject to restrictions imposed by the
security policy plugin. The <i>sudoers</i> policy subjects
environment variables passed as options to the same
restrictions as existing environment variables with one
important difference. If the <i>setenv</i> option is set in
<i>sudoers</i>, the <i>command</i> to be run has the SETENV
tag set or the <i>command</i> matched is <b>ALL</b>, the
user may set variables that would otherwise be forbidden.
See sudoers(5) for more information.</p>

<p style="margin-top: 1em"><b>COMMAND EXECUTION</b></p>

<p style="margin-left:6%;">When <b>sudo</b> executes a
<i>command</i>, the security policy specifies the execution
environment for the <i>command</i>. Typically, the real and
effective user and group and IDs are set to match those of
the target user, as specified in the password database, and
the group vector is initialized based on the group database
(unless the <b>&minus;P</b> option was specified).</p>

<p style="margin-left:6%; margin-top: 1em">The following
parameters may be specified by security policy:</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:10%;">real and effective user-ID</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:10%;">real and effective group-ID</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:10%;">supplementary group-IDs</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:10%;">the environment list</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:10%;">current working directory</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:10%;">file creation mode mask
(umask)</p>

<p style="margin-top: 1em"><b>&bull;</b></p>

<p style="margin-left:10%;">scheduling priority (aka nice
value)</p>

<p style="margin-left:6%; margin-top: 1em"><b>Process
model</b> <br>
There are two distinct ways <b>sudo</b> can run a
<i>command</i>.</p>

<p style="margin-left:6%; margin-top: 1em">If an I/O
logging plugin is configured to log terminal I/O, or if the
security policy explicitly requests it, a new
pseudo-terminal (&ldquo;pty&rdquo;) is allocated and fork(2)
is used to create a second <b>sudo</b> process, referred to
as the <i>monitor</i>. The <i>monitor</i> creates a new
terminal session with itself as the leader and the pty as
its controlling terminal, calls fork(2) again, sets up the
execution environment as described above, and then uses the
execve(2) system call to run the <i>command</i> in the child
process. The <i>monitor</i> exists to relay job control
signals between the user&rsquo;s terminal and the pty the
<i>command</i> is being run in. This makes it possible to
suspend and resume the <i>command</i> normally. Without the
<i>monitor</i>, the <i>command</i> would be in what POSIX
terms an &ldquo;orphaned process group&rdquo; and it would
not receive any job control signals from the kernel. When
the <i>command</i> exits or is terminated by a signal, the
<i>monitor</i> passes the <i>command</i>&rsquo;s exit status
to the main <b>sudo</b> process and exits. After receiving
the <i>command</i>&rsquo;s exit status, the main <b>sudo</b>
process passes the <i>command</i>&rsquo;s exit status to the
security policy&rsquo;s close function, as well as the close
function of any configured audit plugin, and exits.</p>

<p style="margin-left:6%; margin-top: 1em">If no pty is
used, <b>sudo</b> calls fork(2), sets up the execution
environment as described above, and uses the execve(2)
system call to run the <i>command</i> in the child process.
The main <b>sudo</b> process waits until the <i>command</i>
has completed, then passes the <i>command</i>&rsquo;s exit
status to the security policy&rsquo;s close function, as
well as the close function of any configured audit plugins,
and exits. As a special case, if the policy plugin does not
define a close function, <b>sudo</b> will execute the
<i>command</i> directly instead of calling fork(2) first.
The <i>sudoers</i> policy plugin will only define a close
function when I/O logging is enabled, a pty is required, an
SELinux role is specified, the <i>command</i> has an
associated timeout, or the <i>pam_session</i> or
<i>pam_setcred</i> options are enabled. Both
<i>pam_session</i> and <i>pam_setcred</i> are enabled by
default on systems using PAM.</p>

<p style="margin-left:6%; margin-top: 1em">On systems that
use PAM, the security policy&rsquo;s close function is
responsible for closing the PAM session. It may also log the
<i>command</i>&rsquo;s exit status.</p>

<p style="margin-left:6%; margin-top: 1em"><b>Signal
handling</b> <br>
When the <i>command</i> is run as a child of the <b>sudo</b>
process, <b>sudo</b> will relay signals it receives to the
<i>command</i>. The SIGINT and SIGQUIT signals are only
relayed when the <i>command</i> is being run in a new pty or
when the signal was sent by a user process, not the kernel.
This prevents the <i>command</i> from receiving SIGINT twice
each time the user enters control-C. Some signals, such as
SIGSTOP and SIGKILL, cannot be caught and thus will not be
relayed to the <i>command</i>. As a general rule, SIGTSTP
should be used instead of SIGSTOP when you wish to suspend a
<i>command</i> being run by <b>sudo</b>.</p>

<p style="margin-left:6%; margin-top: 1em">As a special
case, <b>sudo</b> will not relay signals that were sent by
the <i>command</i> it is running. This prevents the
<i>command</i> from accidentally killing itself. On some
systems, the reboot(8) utility sends SIGTERM to all
non-system processes other than itself before rebooting the
system. This prevents <b>sudo</b> from relaying the SIGTERM
signal it received back to reboot(8), which might then exit
before the system was actually rebooted, leaving it in a
half-dead state similar to single user mode. Note, however,
that this check only applies to the <i>command</i> run by
<b>sudo</b> and not any other processes that the
<i>command</i> may create. As a result, running a script
that calls reboot(8) or shutdown(8) via <b>sudo</b> may
cause the system to end up in this undefined state unless
the reboot(8) or shutdown(8) are run using the <b>exec</b>()
family of functions instead of <b>system</b>() (which
interposes a shell between the <i>command</i> and the
calling process).</p>

<p style="margin-left:6%; margin-top: 1em"><b>Plugins</b>
<br>
Plugins may be specified via <i>Plugin</i> directives in the
sudo.conf(5) file. They may be loaded as dynamic shared
objects (on systems that support them), or compiled directly
into the <b>sudo</b> binary. If no sudo.conf(5) file is
present, or if it doesn&rsquo;t contain any <i>Plugin</i>
lines, <b>sudo</b> will use sudoers(5) for the policy,
auditing, and I/O logging plugins. See the sudo.conf(5)
manual for details of the <i>/etc/sudo.conf</i> file and the
sudo_plugin(5) manual for more information about the
<b>sudo</b> plugin architecture.</p>

<p style="margin-top: 1em"><b>EXIT VALUE</b></p>

<p style="margin-left:6%;">Upon successful execution of a
<i>command</i>, the exit status from <b>sudo</b> will be the
exit status of the program that was executed. If the
<i>command</i> terminated due to receipt of a signal,
<b>sudo</b> will send itself the same signal that terminated
the <i>command</i>.</p>

<p style="margin-left:6%; margin-top: 1em">If the
<b>&minus;l</b> option was specified without a
<i>command</i>, <b>sudo</b> will exit with a value of 0 if
the user is allowed to run <b>sudo</b> and they
authenticated successfully (as required by the security
policy). If a <i>command</i> is specified with the
<b>&minus;l</b> option, the exit value will only be 0 if the
<i>command</i> is permitted by the security policy,
otherwise it will be 1.</p>

<p style="margin-left:6%; margin-top: 1em">If there is an
authentication failure, a configuration/permission problem,
or if the given <i>command</i> cannot be executed,
<b>sudo</b> exits with a value of 1. In the latter case, the
error string is printed to the standard error. If
<b>sudo</b> cannot stat(2) one or more entries in the
user&rsquo;s PATH, an error is printed to the standard
error. (If the directory does not exist or if it is not
really a directory, the entry is ignored and no error is
printed.) This should not happen under normal circumstances.
The most common reason for stat(2) to return
&ldquo;permission denied&rdquo; is if you are running an
automounter and one of the directories in your PATH is on a
machine that is currently unreachable.</p>

<p style="margin-top: 1em"><b>SECURITY NOTES</b></p>

<p style="margin-left:6%;"><b>sudo</b> tries to be safe
when executing external <i>command</i>s.</p>

<p style="margin-left:6%; margin-top: 1em">To prevent
command spoofing, <b>sudo</b> checks &quot;.&quot; and
&quot;&quot; (both denoting current directory) last when
searching for a <i>command</i> in the user&rsquo;s PATH (if
one or both are in the PATH). Depending on the security
policy, the user&rsquo;s PATH environment variable may be
modified, replaced, or passed unchanged to the program that
<b>sudo</b> executes.</p>

<p style="margin-left:6%; margin-top: 1em">Users should
<i>never</i> be granted <b>sudo</b> privileges to execute
files that are writable by the user or that reside in a
directory that is writable by the user. If the user can
modify or replace the <i>command</i> there is no way to
limit what additional <i>command</i>s they can run.</p>

<p style="margin-left:6%; margin-top: 1em">By default,
<b>sudo</b> will only log the <i>command</i> it explicitly
runs. If a user runs a <i>command</i> such as &lsquo;sudo
su&rsquo; or &lsquo;sudo sh&rsquo;, subsequent
<i>command</i>s run from that shell are not subject to
<b>sudo</b>&rsquo;s security policy. The same is true for
<i>command</i>s that offer shell escapes (including most
editors). If I/O logging is enabled, subsequent
<i>command</i>s will have their input and/or output logged,
but there will not be traditional logs for those
<i>command</i>s. Because of this, care must be taken when
giving users access to <i>command</i>s via <b>sudo</b> to
verify that the <i>command</i> does not inadvertently give
the user an effective root shell. For information on ways to
address this, see the <i>Preventing shell escapes</i>
section in sudoers(5).</p>

<p style="margin-left:6%; margin-top: 1em">To prevent the
disclosure of potentially sensitive information, <b>sudo</b>
disables core dumps by default while it is executing (they
are re-enabled for the <i>command</i> that is run). This
historical practice dates from a time when most operating
systems allowed set-user-ID processes to dump core by
default. To aid in debugging <b>sudo</b> crashes, you may
wish to re-enable core dumps by setting
&ldquo;disable_coredump&rdquo; to false in the sudo.conf(5)
file as follows:</p>

<p style="margin-left:12%; margin-top: 1em">Set
disable_coredump false</p>

<p style="margin-left:6%; margin-top: 1em">See the
sudo.conf(5) manual for more information.</p>

<p style="margin-top: 1em"><b>ENVIRONMENT</b></p>

<p style="margin-left:6%;"><b>sudo</b> utilizes the
following environment variables. The security policy has
control over the actual content of the
<i>command</i>&rsquo;s environment.</p>

<p style="margin-top: 1em">EDITOR</p>

<p style="margin-left:28%; margin-top: 1em">Default editor
to use in <b>&minus;e</b> (sudoedit) mode if neither
SUDO_EDITOR nor VISUAL is set.</p>

<p style="margin-top: 1em">MAIL</p>

<p style="margin-left:28%; margin-top: 1em">Set to the mail
spool of the target user when the <b>&minus;i</b> option is
specified, or when <i>env_reset</i> is enabled in
<i>sudoers</i> (unless MAIL is present in the
<i>env_keep</i> list).</p>

<p style="margin-top: 1em">HOME</p>

<p style="margin-left:28%; margin-top: 1em">Set to the home
directory of the target user when the <b>&minus;i</b> or
<b>&minus;H</b> options are specified, when the
<b>&minus;s</b> option is specified and <i>set_home</i> is
set in <i>sudoers</i>, when <i>always_set_home</i> is
enabled in <i>sudoers</i>, or when <i>env_reset</i> is
enabled in <i>sudoers</i> and HOME is not present in the
<i>env_keep</i> list.</p>

<p style="margin-top: 1em">LOGNAME</p>

<p style="margin-left:28%; margin-top: 1em">Set to the
login name of the target user when the <b>&minus;i</b>
option is specified, when the <i>set_logname</i> option is
enabled in <i>sudoers</i>, or when the <i>env_reset</i>
option is enabled in <i>sudoers</i> (unless LOGNAME is
present in the <i>env_keep</i> list).</p>

<p style="margin-top: 1em">PATH</p>

<p style="margin-left:28%; margin-top: 1em">May be
overridden by the security policy.</p>

<p style="margin-top: 1em">SHELL</p>

<p style="margin-left:28%; margin-top: 1em">Used to
determine shell to run with <b>&minus;s</b> option.</p>

<p style="margin-top: 1em">SUDO_ASKPASS</p>

<p style="margin-left:28%; margin-top: 1em">Specifies the
path to a helper program used to read the password if no
terminal is available or if the <b>&minus;A</b> option is
specified.</p>

<p style="margin-top: 1em">SUDO_COMMAND</p>

<p style="margin-left:28%; margin-top: 1em">Set to the
<i>command</i> run by sudo, including any <i>arg</i>s. The
<i>arg</i>s are truncated at 4096 characters to prevent a
potential execution error.</p>

<p style="margin-top: 1em">SUDO_EDITOR</p>

<p style="margin-left:28%; margin-top: 1em">Default editor
to use in <b>&minus;e</b> (sudoedit) mode.</p>

<p style="margin-top: 1em">SUDO_GID</p>

<p style="margin-left:28%; margin-top: 1em">Set to the
group-ID of the user who invoked sudo.</p>

<p style="margin-top: 1em">SUDO_PROMPT</p>

<p style="margin-left:28%; margin-top: 1em">Used as the
default password prompt unless the <b>&minus;p</b> option
was specified.</p>

<p style="margin-top: 1em">SUDO_PS1</p>

<p style="margin-left:28%; margin-top: 1em">If set, PS1
will be set to its value for the program being run.</p>

<p style="margin-top: 1em">SUDO_UID</p>

<p style="margin-left:28%; margin-top: 1em">Set to the
user-ID of the user who invoked sudo.</p>

<p style="margin-top: 1em">SUDO_USER</p>

<p style="margin-left:28%; margin-top: 1em">Set to the
login name of the user who invoked sudo.</p>

<p style="margin-top: 1em">USER</p>

<p style="margin-left:28%; margin-top: 1em">Set to the same
value as LOGNAME, described above.</p>

<p style="margin-top: 1em">VISUAL</p>

<p style="margin-left:28%; margin-top: 1em">Default editor
to use in <b>&minus;e</b> (sudoedit) mode if SUDO_EDITOR is
not set.</p>

<p style="margin-top: 1em"><b>FILES</b> <br>
/etc/sudo.conf</p>

<p style="margin-left:40%; margin-top: 1em"><b>sudo</b>
front-end configuration</p>

<p style="margin-top: 1em"><b>EXAMPLES</b></p>

<p style="margin-left:6%;">The following examples assume a
properly configured security policy.</p>

<p style="margin-left:6%; margin-top: 1em">To get a file
listing of an unreadable directory:</p>

<p style="margin-left:12%; margin-top: 1em">$ sudo ls
/usr/local/protected</p>

<p style="margin-left:6%; margin-top: 1em">To list the home
directory of user yaz on a machine where the file system
holding ~yaz is not exported as root:</p>

<p style="margin-left:12%; margin-top: 1em">$ sudo -u yaz
ls ~yaz</p>

<p style="margin-left:6%; margin-top: 1em">To edit the
<i>index.html</i> file as user www:</p>

<p style="margin-left:12%; margin-top: 1em">$ sudoedit -u
www ~www/htdocs/index.html</p>

<p style="margin-left:6%; margin-top: 1em">To view system
logs only accessible to root and users in the adm group:</p>

<p style="margin-left:12%; margin-top: 1em">$ sudo -g adm
more /var/log/syslog</p>

<p style="margin-left:6%; margin-top: 1em">To run an editor
as jim with a different primary group:</p>

<p style="margin-left:12%; margin-top: 1em">$ sudoedit -u
jim -g audio ~jim/sound.txt</p>

<p style="margin-left:6%; margin-top: 1em">To shut down a
machine:</p>

<p style="margin-left:12%; margin-top: 1em">$ sudo shutdown
-r +15 &quot;quick reboot&quot;</p>

<p style="margin-left:6%; margin-top: 1em">To make a usage
listing of the directories in the /home partition. The
<i>commands</i> are run in a sub-shell to allow the
&lsquo;cd&rsquo; command and file redirection to work.</p>

<p style="margin-left:12%; margin-top: 1em">$ sudo sh -c
&quot;cd /home ; du -s * | sort -rn &gt; USAGE&quot;</p>

<p style="margin-top: 1em"><b>DIAGNOSTICS</b></p>

<p style="margin-left:6%;">Error messages produced by
<b>sudo</b> include:</p>

<p style="margin-top: 1em">editing files in a writable
directory is not permitted</p>

<p style="margin-left:14%;">By default, <b>sudoedit</b>
does not permit editing a file when any of the parent
directories are writable by the invoking user. This avoids a
race condition that could allow the user to overwrite an
arbitrary file. See the <i>sudoedit_checkdir</i> option in
sudoers(5) for more information.</p>

<p style="margin-top: 1em">editing symbolic links is not
permitted</p>

<p style="margin-left:14%;">By default, <b>sudoedit</b>
does not follow symbolic links when opening files. See the
<i>sudoedit_follow</i> option in sudoers(5) for more
information.</p>

<p style="margin-top: 1em">effective uid is not 0, is sudo
installed setuid root?</p>

<p style="margin-left:14%;"><b>sudo</b> was not run with
root privileges. The <b>sudo</b> binary must be owned by the
root user and have the set-user-ID bit set. Also, it must
not be located on a file system mounted with the
&lsquo;nosuid&rsquo; option or on an NFS file system that
maps uid 0 to an unprivileged uid.</p>

<p style="margin-top: 1em">effective uid is not 0, is sudo
on a file system with the &rsquo;nosuid&rsquo; option set or
an NFS file system without root privileges?</p>

<p style="margin-left:14%;"><b>sudo</b> was not run with
root privileges. The <b>sudo</b> binary has the proper owner
and permissions but it still did not run with root
privileges. The most common reason for this is that the file
system the <b>sudo</b> binary is located on is mounted with
the &lsquo;nosuid&rsquo; option or it is an NFS file system
that maps uid 0 to an unprivileged uid.</p>

<p style="margin-top: 1em">fatal error, unable to load
plugins</p>

<p style="margin-left:14%;">An error occurred while loading
or initializing the plugins specified in sudo.conf(5).</p>

<p style="margin-top: 1em">invalid environment variable
name</p>

<p style="margin-left:14%;">One or more environment
variable names specified via the <b>&minus;E</b> option
contained an equal sign (&lsquo;=&rsquo;). The arguments to
the <b>&minus;E</b> option should be environment variable
names without an associated value.</p>

<p style="margin-top: 1em">no password was provided</p>

<p style="margin-left:14%;">When <b>sudo</b> tried to read
the password, it did not receive any characters. This may
happen if no terminal is available (or the <b>&minus;S</b>
option is specified) and the standard input has been
redirected from <i>/dev/null</i>.</p>

<p style="margin-top: 1em">a terminal is required to read
the password</p>

<p style="margin-left:14%;"><b>sudo</b> needs to read the
password but there is no mechanism available for it to do
so. A terminal is not present to read the password from,
<b>sudo</b> has not been configured to read from the
standard input, the <b>&minus;S</b> option was not used, and
no askpass helper has been specified either via the
sudo.conf(5) file or the SUDO_ASKPASS environment
variable.</p>

<p style="margin-top: 1em">no writable temporary directory
found</p>

<p style="margin-left:14%;"><b>sudoedit</b> was unable to
find a usable temporary directory in which to store its
intermediate files.</p>

<p style="margin-top: 1em">The &ldquo; <br>
no new privileges&rdquo; flag is set, which prevents sudo
from running as root.</p>

<p style="margin-left:14%;"><b>sudo</b> was run by a
process that has the Linux &ldquo;no new privileges&rdquo;
flag is set. This causes the set-user-ID bit to be ignored
when running an executable, which will prevent <b>sudo</b>
from functioning. The most likely cause for this is running
<b>sudo</b> within a container that sets this flag. Check
the documentation to see if it is possible to configure the
container such that the flag is not set.</p>

<p style="margin-top: 1em">sudo must be owned by uid 0 and
have the setuid bit set</p>

<p style="margin-left:14%;"><b>sudo</b> was not run with
root privileges. The <b>sudo</b> binary does not have the
correct owner or permissions. It must be owned by the root
user and have the set-user-ID bit set.</p>

<p style="margin-top: 1em">sudoedit is not supported on
this platform</p>

<p style="margin-left:14%;">It is only possible to run
<b>sudoedit</b> on systems that support setting the
effective user-ID.</p>

<p style="margin-top: 1em">timed out reading password</p>

<p style="margin-left:14%;">The user did not enter a
password before the password timeout (5 minutes by default)
expired.</p>

<p style="margin-top: 1em">you do not exist in the passwd
database</p>

<p style="margin-left:14%;">Your user-ID does not appear in
the system passwd database.</p>

<p style="margin-top: 1em">you may not specify environment
variables in edit mode</p>

<p style="margin-left:14%;">It is only possible to specify
environment variables when running a <i>command</i>. When
editing a file, the editor is run with the user&rsquo;s
environment unmodified.</p>

<p style="margin-top: 1em"><b>SEE ALSO</b></p>

<p style="margin-left:6%;">su(1), stat(2), login_cap(3),
passwd(5), sudo.conf(5), sudo_plugin(5), sudoers(5),
sudoers_timestamp(5), sudoreplay(8), visudo(8)</p>

<p style="margin-top: 1em"><b>HISTORY</b></p>

<p style="margin-left:6%;">See the HISTORY.md file in the
<b>sudo</b> distribution
(https://www.sudo.ws/about/history/) for a brief history of
sudo.</p>

<p style="margin-top: 1em"><b>AUTHORS</b></p>

<p style="margin-left:6%;">Many people have worked on
<b>sudo</b> over the years; this version consists of code
written primarily by:</p>

<p style="margin-left:14%; margin-top: 1em">Todd C.
Miller</p>

<p style="margin-left:6%; margin-top: 1em">See the
CONTRIBUTORS.md file in the <b>sudo</b> distribution
(https://www.sudo.ws/about/contributors/) for an exhaustive
list of people who have contributed to <b>sudo</b>.</p>

<p style="margin-top: 1em"><b>CAVEATS</b></p>

<p style="margin-left:6%;">There is no easy way to prevent
a user from gaining a root shell if that user is allowed to
run arbitrary <i>commands</i> via <b>sudo</b>. Also, many
programs (such as editors) allow the user to run
<i>command</i>s via shell escapes, thus avoiding
<b>sudo</b>&rsquo;s checks. However, on most systems it is
possible to prevent shell escapes with the sudoers(5)
plugin&rsquo;s <i>noexec</i> functionality.</p>

<p style="margin-left:6%; margin-top: 1em">It is not
meaningful to run the &lsquo;cd&rsquo; <i>command</i>
directly via sudo, e.g.,</p>

<p style="margin-left:12%; margin-top: 1em">$ sudo cd
/usr/local/protected</p>

<p style="margin-left:6%; margin-top: 1em">since when the
<i>command</i> exits the parent process (your shell) will
still be the same. The <b>&minus;D</b> option can be used to
run a <i>command</i> in a specific <i>directory</i>.</p>

<p style="margin-left:6%; margin-top: 1em">Running shell
scripts via <b>sudo</b> can expose the same kernel bugs that
make set-user-ID shell scripts unsafe on some operating
systems (if your OS has a /dev/fd/ directory, set-user-ID
shell scripts are generally safe).</p>

<p style="margin-top: 1em"><b>BUGS</b></p>

<p style="margin-left:6%;">If you believe you have found a
bug in <b>sudo</b>, you can submit a bug report at
https://bugzilla.sudo.ws/</p>

<p style="margin-top: 1em"><b>SUPPORT</b></p>

<p style="margin-left:6%;">Limited free support is
available via the sudo-users mailing list, see
https://www.sudo.ws/mailman/listinfo/sudo-users to subscribe
or search the archives.</p>

<p style="margin-top: 1em"><b>DISCLAIMER</b></p>

<p style="margin-left:6%;"><b>sudo</b> is provided
&ldquo;AS IS&rdquo; and any express or implied warranties,
including, but not limited to, the implied warranties of
merchantability and fitness for a particular purpose are
disclaimed. See the LICENSE.md file distributed with
<b>sudo</b> or https://www.sudo.ws/about/license/ for
complete details.</p>

<p style="margin-left:6%; margin-top: 1em">Sudo 1.9.13p3
January&nbsp;16, 2023 Sudo 1.9.13p3</p>
<hr>
</body>
</html>
