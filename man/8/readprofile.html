<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:57:07 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>READPROFILE</title>

</head>
<body>
<h1>readprofile</h1>



<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">readprofile
&minus; read kernel profiling information</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>readprofile</b>
[options]</p>

<h2>VERSION
<a name="VERSION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This manpage
documents version 2.0 of the program.</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>readprofile</b> command uses the <i>/proc/profile</i>
information to print ascii data on standard output. The
output is organized in three columns: the first is the
number of clock ticks, the second is the name of the C
function in the kernel where those many ticks occurred, and
the third is the normalized &lsquo;load' of the procedure,
calculated as a ratio between the number of ticks and the
length of the procedure. The output is filled with blanks to
ease readability.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>&minus;a</b>,
<b>&minus;&minus;all</b></p>

<p style="margin-left:17%;">Print all symbols in the
mapfile. By default the procedures with reported ticks are
not printed.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;b</b>,
<b>&minus;&minus;histbin</b></p>

<p style="margin-left:17%;">Print individual
histogram&minus;bin counts.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;i</b>,
<b>&minus;&minus;info</b></p>

<p style="margin-left:17%;">Info. This makes
<b>readprofile</b> only print the profiling step used by the
kernel. The profiling step is the resolution of the
profiling buffer, and is chosen during kernel configuration
(through <b>make config</b>), or in the kernel&rsquo;s
command line. If the <b>&minus;t</b> (terse) switch is used
together with <b>&minus;i</b> only the decimal number is
printed.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;m</b>,
<b>&minus;&minus;mapfile</b> <i>mapfile</i></p>

<p style="margin-left:17%;">Specify a mapfile, which by
default is <i>/usr/src/linux/System.map</i>. You should
specify the map file on cmdline if your current kernel
isn&rsquo;t the last one you compiled, or if you keep
System.map elsewhere. If the name of the map file ends with
<i>.gz</i> it is decompressed on the fly.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;M</b>,
<b>&minus;&minus;multiplier</b> <i>multiplier</i></p>

<p style="margin-left:17%;">On some architectures it is
possible to alter the frequency at which the kernel delivers
profiling interrupts to each CPU. This option allows you to
set the frequency, as a multiplier of the system clock
frequency, HZ. Linux 2.6.16 dropped multiplier support for
most systems. This option also resets the profiling buffer,
and requires superuser privileges.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;p</b>,
<b>&minus;&minus;profile</b> <i>pro&minus;file</i></p>

<p style="margin-left:17%;">Specify a different profiling
buffer, which by default is <i>/proc/profile</i>. Using a
different pro&minus;file is useful if you want to
&lsquo;freeze' the kernel profiling at some time and read it
later. The <i>/proc/profile</i> file can be copied using
<b>cat</b>(1) or <b>cp</b>(1). There is no more support for
compressed profile buffers, like in
<b>readprofile&minus;1.1</b>, because the program needs to
know the size of the buffer in advance.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;r</b>,
<b>&minus;&minus;reset</b></p>

<p style="margin-left:17%;">Reset the profiling buffer.
This can only be invoked by root, because
<i>/proc/profile</i> is readable by everybody but writable
only by the superuser. However, you can make
<b>readprofile</b> set&minus;user&minus;ID 0, in order to
reset the buffer without gaining privileges.</p>

<p style="margin-left:11%; margin-top: 1em"><b>&minus;s,
&minus;&minus;counters</b></p>

<p style="margin-left:17%;">Print individual counters
within functions.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;v</b>,
<b>&minus;&minus;verbose</b></p>

<p style="margin-left:17%;">Verbose. The output is
organized in four columns and filled with blanks. The first
column is the RAM address of a kernel function, the second
is the name of the function, the third is the number of
clock ticks and the last is the normalized load.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;h</b>,
<b>&minus;&minus;help</b></p>

<p style="margin-left:17%;">Display help text and exit.</p>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;V</b>,
<b>&minus;&minus;version</b></p>

<p style="margin-left:17%;">Print version and exit.</p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>/proc/profile</i></p>

<p style="margin-left:17%;">A binary snapshot of the
profiling buffer.</p>


<p style="margin-left:11%; margin-top: 1em"><i>/usr/src/linux/System.map</i></p>

<p style="margin-left:17%;">The symbol table for the
kernel.</p>


<p style="margin-left:11%; margin-top: 1em"><i>/usr/src/linux/*</i></p>

<p style="margin-left:17%;">The program being profiled
:&minus;)</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>readprofile</b>
only works with a 1.3.x or newer kernel, because
<i>/proc/profile</i> changed in the step from 1.2 to
1.3.</p>

<p style="margin-left:11%; margin-top: 1em">This program
only works with ELF kernels. The change for a.out kernels is
trivial, and left as an exercise to the a.out user.</p>

<p style="margin-left:11%; margin-top: 1em">To enable
profiling, the kernel must be rebooted, because no profiling
module is available, and it wouldn&rsquo;t be easy to build.
To enable profiling, you can specify <b>profile</b>=<i>2</i>
(or another number) on the kernel commandline. The number
you specify is the two&minus;exponent used as profiling
step.</p>

<p style="margin-left:11%; margin-top: 1em">Profiling is
disabled when interrupts are inhibited. This means that many
profiling ticks happen when interrupts are re&minus;enabled.
Watch out for misleading information.</p>

<h2>EXAMPLE
<a name="EXAMPLE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Browse the
profiling buffer ordering by clock ticks:</p>

<p style="margin-left:17%; margin-top: 1em">readprofile |
sort &minus;nr | less</p>

<p style="margin-left:11%; margin-top: 1em">Print the 20
most loaded procedures:</p>

<p style="margin-left:17%; margin-top: 1em">readprofile |
sort &minus;nr +2 | head &minus;20</p>

<p style="margin-left:11%; margin-top: 1em">Print only
filesystem profile:</p>

<p style="margin-left:17%; margin-top: 1em">readprofile |
grep _ext2</p>

<p style="margin-left:11%; margin-top: 1em">Look at all the
kernel information, with ram addresses:</p>

<p style="margin-left:17%; margin-top: 1em">readprofile
&minus;av | less</p>

<p style="margin-left:11%; margin-top: 1em">Browse a
'frozen' profile buffer for a non current kernel:</p>

<p style="margin-left:17%; margin-top: 1em">readprofile
&minus;p ~/profile.freeze &minus;m /zImage.map.gz</p>

<p style="margin-left:11%; margin-top: 1em">Request
profiling at 2kHz per CPU, and reset the profiling
buffer:</p>

<p style="margin-left:17%; margin-top: 1em">sudo
readprofile &minus;M 20</p>

<h2>REPORTING BUGS
<a name="REPORTING BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For bug
reports, use the issue tracker at
&lt;https://github.com/util&minus;linux/util&minus;linux/issues&gt;.</p>

<h2>AVAILABILITY
<a name="AVAILABILITY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>readprofile</b> command is part of the util&minus;linux
package which can be downloaded from <i>Linux Kernel
Archive</i>
&lt;https://www.kernel.org/pub/linux/utils/util&minus;linux/&gt;.</p>
<hr>
</body>
</html>
