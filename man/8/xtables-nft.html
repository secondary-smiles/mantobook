<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:57:10 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>XTABLES-NFT</title>

</head>
<body>
<h1>xtables-nft</h1>



<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">xtables-nft
&mdash; iptables using nftables kernel api</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>xtables-nft</b>
are versions of iptables that use the nftables API. This is
a set of tools to help the system administrator migrate the
ruleset from <b>iptables(8)</b>, <b>ip6tables(8)</b>,
<b>arptables(8)</b>, and <b>ebtables(8)</b> to
<b>nftables(8)</b>.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>xtables-nft</b> set is composed of several commands:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>iptables&minus;nft</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>iptables&minus;nft&minus;save</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>iptables&minus;nft&minus;restore</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>ip6tables&minus;nft</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>ip6tables&minus;nft&minus;save</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>ip6tables&minus;nft&minus;restore</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>arptables&minus;nft</p></td>
<td width="54%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="2%"></td>
<td width="32%">


<p>ebtables&minus;nft</p></td>
<td width="54%">
</td></tr>
</table>

<p style="margin-left:14%; margin-top: 1em">These tools use
the libxtables framework extensions and hook to the
nf_tables kernel subsystem using the <b>nft_compat</b>
module.</p>

<h2>USAGE
<a name="USAGE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The xtables-nft
tools allow you to manage the nf_tables backend using the
native syntax of <b>iptables(8)</b>, <b>ip6tables(8)</b>,
<b>arptables(8)</b>, and <b>ebtables(8)</b>.</p>

<p style="margin-left:11%; margin-top: 1em">You should use
the xtables-nft tools exactly the same way as you would use
the corresponding original tools.</p>

<p style="margin-left:11%; margin-top: 1em">Adding a rule
will result in that rule being added to the nf_tables kernel
subsystem instead. Listing the ruleset will use the
nf_tables backend as well.</p>

<p style="margin-left:11%; margin-top: 1em">When these
tools were designed, the main idea was to replace each
legacy binary with a symlink to the xtables-nft program, for
example:</p>

<p style="margin-left:11%; margin-top: 1em">/sbin/iptables
-&gt; /usr/sbin/iptables&minus;nft&minus;multi</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p>/sbin/ip6tables -&gt;
/usr/sbin/ip6tables&minus;nft&minus;multi</p> </td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p>/sbin/arptables -&gt;
/usr/sbin/arptables&minus;nft&minus;multi</p> </td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p>/sbin/ebtables -&gt;
/usr/sbin/ebtables&minus;nft&minus;multi</p> </td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The iptables
version string will indicate whether the legacy API
(get/setsockopt) or the new nf_tables api is used:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p>iptables &minus;V</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p>iptables v1.7 (nf_tables)</p></td></tr>
</table>

<h2>DIFFERENCES TO LEGACY IPTABLES
<a name="DIFFERENCES TO LEGACY IPTABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Because the
xtables-nft tools use the nf_tables kernel API, rule
additions and deletions are always atomic. Unlike
iptables-legacy, iptables-nft &minus;A .. will NOT need to
retrieve the current ruleset from the kernel, change it, and
re-load the altered ruleset. Instead, iptables-nft will tell
the kernel to add one rule. For this reason, the
iptables-legacy &minus;&minus;wait option is a no-op in
iptables-nft.</p>

<p style="margin-left:11%; margin-top: 1em">Use of the
xtables-nft tools allow monitoring ruleset changes using the
<b>xtables&minus;monitor(8)</b> command.</p>

<p style="margin-left:11%; margin-top: 1em">When using
&minus;j TRACE to debug packet traversal to the ruleset,
note that you will need to use
<b>xtables&minus;monitor(8)</b> in &minus;&minus;trace mode
to obtain monitoring trace events.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">One basic
example is creating the skeleton ruleset in nf_tables from
the xtables-nft tools, in a fresh machine:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>root@machine:~# iptables&minus;nft &minus;L</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>[...]</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>root@machine:~# ip6tables&minus;nft &minus;L</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>[...]</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>root@machine:~# arptables&minus;nft &minus;L</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>[...]</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>root@machine:~# ebtables&minus;nft &minus;L</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>[...]</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>root@machine:~# nft list ruleset</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>table ip filter {</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain INPUT {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook input priority 0; policy accept;</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain FORWARD {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook forward priority 0; policy accept;</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain OUTPUT {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook output priority 0; policy accept;</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>}</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>table ip6 filter {</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain INPUT {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook input priority 0; policy accept;</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain FORWARD {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook forward priority 0; policy accept;</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain OUTPUT {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook output priority 0; policy accept;</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>}</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>table bridge filter {</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain INPUT {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook input priority &minus;200; policy
accept;</p> </td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain FORWARD {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook forward priority &minus;200; policy
accept;</p> </td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain OUTPUT {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook output priority &minus;200; policy
accept;</p> </td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>}</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>table arp filter {</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain INPUT {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook input priority 0; policy accept;</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain FORWARD {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook forward priority 0; policy accept;</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>chain OUTPUT {</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">
</td>
<td width="69%">


<p>type filter hook output priority 0; policy accept;</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%">
</td>
<td width="8%">
</td>
<td width="8%">


<p>}</p></td>
<td width="69%">
</td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="7%"></td>
<td width="8%">


<p>}</p></td>
<td width="8%"></td>
<td width="69%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">(please note
that in fresh machines, listing the ruleset for the first
time results in all tables an chain being created).</p>

<p style="margin-left:11%; margin-top: 1em">To migrate your
complete filter ruleset, in the case of <b>iptables(8)</b>,
you would use:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p>root@machine:~# iptables&minus;legacy&minus;save &gt;
myruleset # reads from x_tables</p></td></tr>
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p>root@machine:~# iptables&minus;nft&minus;restore
myruleset # writes to nf_tables</p></td></tr>
</table>

<p style="margin-left:11%;">or</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="8%"></td>
<td width="92%">


<p>root@machine:~# iptables&minus;legacy&minus;save |
iptables-translate-restore | less</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">to see how
rules would look like in the nft <b>nft(8)</b> syntax.</p>

<h2>LIMITATIONS
<a name="LIMITATIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">You should use
<b>Linux kernel &gt;= 4.17</b>.</p>

<p style="margin-left:11%; margin-top: 1em">The CLUSTERIP
target is not supported.</p>

<p style="margin-left:11%; margin-top: 1em">To get
up-to-date information about this, please head to
<b>http://wiki.nftables.org/</b>.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>nft(8)</b>,
<b>xtables&minus;translate(8)</b>,
<b>xtables&minus;monitor(8)</b></p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The nftables
framework is written by the Netfilter project
(https://www.netfilter.org).</p>

<p style="margin-left:11%; margin-top: 1em">This manual
page was written by Arturo Borrero Gonzalez
&lt;arturo@debian.org&gt; for the Debian project, but may be
used by others.</p>

<p style="margin-left:11%; margin-top: 1em">This
documentation is free/libre under the terms of the
GPLv2+.</p>
<hr>
</body>
</html>
