<!-- Creator     : groff version 1.22.4 -->
<!-- CreationDate: Mon May 29 22:57:07 2023 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PAM_SUCCEED_IF</title>

</head>
<body>
<h1>pam_succeed_if</h1>



<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">pam_succeed_if
&minus; test account characteristics</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="64%">


<p style="margin-top: 1em"><b>pam_succeed_if.so</b>
[<i>flag</i>...] [<i>condition</i>...]</p></td>
<td width="25%">
</td></tr>
</table>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">pam_succeed_if.so
is designed to succeed or fail authentication based on
characteristics of the account belonging to the user being
authenticated or values of other PAM items. One use is to
select whether to load other modules based on this test.</p>

<p style="margin-left:11%; margin-top: 1em">The module
should be given one or more conditions as module arguments,
and authentication will succeed only if all of the
conditions are met.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
<i>flag</i>s are supported:</p>

<p style="margin-left:11%; margin-top: 1em">debug</p>

<p style="margin-left:17%;">Turns on debugging messages
sent to syslog.</p>

<p style="margin-left:11%; margin-top: 1em">use_uid</p>

<p style="margin-left:17%;">Evaluate conditions using the
account of the user whose UID the application is running
under instead of the user being authenticated.</p>

<p style="margin-left:11%; margin-top: 1em">quiet</p>

<p style="margin-left:17%;">Don't log failure or success to
the system log.</p>

<p style="margin-left:11%; margin-top: 1em">quiet_fail</p>

<p style="margin-left:17%;">Don't log failure to the system
log.</p>


<p style="margin-left:11%; margin-top: 1em">quiet_success</p>

<p style="margin-left:17%;">Don't log success to the system
log.</p>

<p style="margin-left:11%; margin-top: 1em">audit</p>

<p style="margin-left:17%;">Log unknown users to the system
log.</p>


<p style="margin-left:11%; margin-top: 1em"><i>Condition</i>s
are three words: a field, a test, and a value to test
for.</p>

<p style="margin-left:11%; margin-top: 1em">Available
fields are <i>user</i>, <i>uid</i>, <i>gid</i>,
<i>shell</i>, <i>home</i>, <i>ruser</i>, <i>rhost</i>,
<i>tty</i> and <i>service</i>:</p>

<p style="margin-left:11%; margin-top: 1em">field &lt;
number</p>

<p style="margin-left:17%;">Field has a value numerically
less than number.</p>

<p style="margin-left:11%; margin-top: 1em">field &lt;=
number</p>

<p style="margin-left:17%;">Field has a value numerically
less than or equal to number.</p>

<p style="margin-left:11%; margin-top: 1em">field eq
number</p>

<p style="margin-left:17%;">Field has a value numerically
equal to number.</p>

<p style="margin-left:11%; margin-top: 1em">field &gt;=
number</p>

<p style="margin-left:17%;">Field has a value numerically
greater than or equal to number.</p>

<p style="margin-left:11%; margin-top: 1em">field &gt;
number</p>

<p style="margin-left:17%;">Field has a value numerically
greater than number.</p>

<p style="margin-left:11%; margin-top: 1em">field ne
number</p>

<p style="margin-left:17%;">Field has a value numerically
different from number.</p>

<p style="margin-left:11%; margin-top: 1em">field =
string</p>

<p style="margin-left:17%;">Field exactly matches the given
string.</p>

<p style="margin-left:11%; margin-top: 1em">field !=
string</p>

<p style="margin-left:17%;">Field does not match the given
string.</p>

<p style="margin-left:11%; margin-top: 1em">field =~
glob</p>

<p style="margin-left:17%;">Field matches the given
glob.</p>

<p style="margin-left:11%; margin-top: 1em">field !~
glob</p>

<p style="margin-left:17%;">Field does not match the given
glob.</p>

<p style="margin-left:11%; margin-top: 1em">field in
item:item:...</p>

<p style="margin-left:17%;">Field is contained in the list
of items separated by colons.</p>

<p style="margin-left:11%; margin-top: 1em">field notin
item:item:...</p>

<p style="margin-left:17%;">Field is not contained in the
list of items separated by colons.</p>

<p style="margin-left:11%; margin-top: 1em">user ingroup
group[:group:....]</p>

<p style="margin-left:17%;">User is in given group(s).</p>

<p style="margin-left:11%; margin-top: 1em">user notingroup
group[:group:....]</p>

<p style="margin-left:17%;">User is not in given
group(s).</p>

<p style="margin-left:11%; margin-top: 1em">user innetgr
netgroup</p>

<p style="margin-left:17%;">(user,host) is in given
netgroup.</p>

<p style="margin-left:11%; margin-top: 1em">user notinnetgr
group</p>

<p style="margin-left:17%;">(user,host) is not in given
netgroup.</p>

<h2>MODULE TYPES PROVIDED
<a name="MODULE TYPES PROVIDED"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">All module
types (<b>account</b>, <b>auth</b>, <b>password</b> and
<b>session</b>) are provided.</p>

<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">PAM_SUCCESS</p>

<p style="margin-left:17%;">The condition was true.</p>


<p style="margin-left:11%; margin-top: 1em">PAM_AUTH_ERR</p>

<p style="margin-left:17%;">The condition was false.</p>


<p style="margin-left:11%; margin-top: 1em">PAM_SERVICE_ERR</p>

<p style="margin-left:17%;">A service error occurred or the
arguments can't be parsed correctly.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To emulate the
behaviour of <i>pam_wheel</i>, except there is no fallback
to group 0 being only approximated by checking also the root
group membership:</p>

<p style="margin-left:17%; margin-top: 1em">auth required
pam_succeed_if.so quiet user ingroup wheel:root</p>

<p style="margin-left:11%; margin-top: 1em">Given that the
type matches, only loads the othermodule rule if the UID is
over 500. Adjust the number after default to skip several
rules.</p>

<p style="margin-left:17%; margin-top: 1em">type [default=1
success=ignore] pam_succeed_if.so quiet uid &gt; 500 <br>
type required othermodule.so arguments...</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>glob</b>(7),
<b>pam</b>(8)</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Nalin Dahyabhai
&lt;nalin@redhat.com&gt;</p>
<hr>
</body>
</html>
